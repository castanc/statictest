<!DOCTYPE html>
<html>

<head>
  <title>Cryptify</title>
  <meta name="viewport"
    content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
  <meta http-equiv="Accept-CH" content="Device-Memory">

  <base target="_top">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">

  <!-- jQuery library -->
  <!--
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  -->

  <!-- Popper JS -->
  <!--
  <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.16.0/umd/popper.min.js"></script>
  -->

  <!-- Latest compiled JavaScript -->
  <!--
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
  -->

  <!-- FontAwesome -->
  <!--
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
  -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.13.0/css/all.min.css">

  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
<style>.topnav{background-color:#333;overflow:hidden}.topnav a{float:left;display:block;color:#f2f2f2;text-align:center;padding:14px 16px;text-decoration:none;font-size:64px}.topnav a:hover{background-color:#ddd;color:#000}.topnav a.active{background-color:#04aa6d;color:#fff}.topnav .icon{display:none}@media screen and (max-width:600px){.topnav a:not(:first-child){display:none}.topnav a.icon{float:right;display:block}}@media screen and (max-width:600px){.topnav.responsive{position:relative}.topnav.responsive a.icon{position:absolute;right:0;top:0}.topnav.responsive a{float:none;display:block;text-align:left}}.text-responsive{font-size:calc(50% + 1vw + 1vh)}.corners2{border-radius:24px;border:.1em solid #fff;width:100%;padding:32px 32px 32px 32px}.dark-forced{background-color:#282828;color:#fff}.black-text{color:#000}.btn{border-radius:12px;font-size:.5em}lbl-size{font-size:4em}fld-size{font-size:8em}textarea{resize:vertical;font-size:3em}.full-height{width:100%;height:100%}input{font-size:3em}.file-fontsize{font-size:.3em}.card1{background-color:#282828}.card2{background-color:#181818;width:100%}.card-reportline{background-color:#181818;width:100%;font-size:2em}.card3{background-color:#383838}.card-settings{background-color:#484848}.out-text{width:100%;background-color:#000;color:#add8e6;font-size:2em}.field-size{font-size:1.5em}.red{color:red}.blue{color:#00f}.green{color:green}file-selection{font-size:1.5em}iframe{width:100%;height:100%;border:0}object{width:100%;height:100%;border:0}html{max-width:100%;overflow-x:hidden}img{width:100%;height:auto}label{font-size:1em;color:#fff}fileinfo-size{font-size:.5em}input:disabled{background-color:#000;color:grey}textarea:disabled{background-color:#000;color:grey}.icon-label{font-size:.75em}.icon-size{font-size:.75em}.icon-size2{font-size:3em}.icon-size3{font-size:2em}.footer-size{font-size:1em}.text-responsive2{font-size:2em}.text-responsive1_5{font-size:1.5em}.text-responsive3{font-size:3em}z1{position:absolute;left:0;top:0;z-index:-1}.nav>li>a,.navbar-brand{padding:30px 15px}.footer{position:fixed;left:0;bottom:0;width:100%;color:#fff;text-align:center}.no-drop{cursor:no-drop}.cursorPointer{cursor:pointer}.big-font{font-size:2em}.title-font{font-size:42px}.bigger-font{font-size:38px}.fat-row{height:60px}.thumb{width:100px;min-height:100px;float:left;margin:0}.colored{color:#00f}#body{font-size:14px}table,td,th{border:1px solid #000;border-collapse:collapse}.no-outline :focus,.no-outline a:focus{outline:0;box-shadow:none}.no-outline .tab-item:focus{box-shadow:none!important}body{min-width:30rem;overflow-x:auto;min-width:28.125rem;max-width:100%;overflow-x:hidden}.height-500{height:31.25rem}.height-350{height:21.875rem}.height-50{height:3.125rem}.a-nav-toggler-icon-wrapper{min-width:1.25rem}.a-template-container{background-color:var(--theme-color-content);min-width:28.125rem}.a-header{min-width:28.125rem;position:sticky;top:0;z-index:10}#search-icon-sm{display:inline-block}@media screen and (min-width:38.75rem){#search-icon-sm{display:none!important}#a-hfn-search-bar-small{display:block!important}.a-order-sm-1{order:1!important}.a-order-sm-2{order:2!important}.a-order-sm-3{order:3!important}}@media screen and (max-width:61.9375rem){.a-hfn-menu-container{max-width:100%;flex-basis:100%}#hfn-content-container.a-template-content{min-height:calc(100vh - 9.375rem)}}@media screen and (min-width:62rem){.a-hfn-menu-container{min-width:32rem}}.a-header .link-icon .icon-grid-view-outline{padding:.4375rem}.a-hfn-menu-container .a-tab-header .tab-item{height:3.125rem!important;line-height:3.125rem!important;margin-top:0}.a-template-content{position:relative;display:block;width:100%;min-height:calc(100vh - 5.625rem)}.footer-wrapper{position:relative}@media all and (-ms-high-contrast:none),(-ms-high-contrast:active){.a-header{position:fixed}#hfn-content-container.a-template-content{padding-top:3.125rem;transition-duration:1s;min-height:calc(100vh - 2.5rem)}#hfn-content-container.hfn-pt-150,.hfn-pt-150{padding-top:9.375rem}@media screen and (max-width:61.9375rem){#hfn-content-container.a-template-content{padding-top:6.25rem}}}@supports (-ms-accelerator:true){.a-header{position:fixed}#hfn-content-container.a-template-content{padding-top:3.125rem;transition-duration:1s;min-height:calc(100vh - 2.5rem)}#hfn-content-container.hfn-pt-150,.hfn-pt-150{padding-top:9.375rem}@media screen and (max-width:61.9375rem){#hfn-content-container.a-template-content{padding-top:6.25rem}}}@supports (-ms-ime-align:auto){.a-header{position:fixed}#hfn-content-container.a-template-content{padding-top:3.125rem;transition-duration:1s;min-height:calc(100vh - 2.5rem)}#hfn-content-container.hfn-pt-150,.hfn-pt-150{padding-top:9.375rem}@media screen and (max-width:61.9375rem){#hfn-content-container.a-template-content{padding-top:6.25rem}}}.numField{background-color:#000;color:#fff}.separation-right{margin-bottom:1em}.separation{margin-bottom:1em}.separation-row{margin-bottom:1em;margin-top:1em}.separation-center{margin-left:1em;margin-right:1em}.separation-menu{margin-left:.5em;margin-right:.5em;font-size:1.5em}.separation-all{margin-left:1em;margin-right:1em;margin-bottom:1em;margin-top:1em}.icon-sep{margin-left:1em;margin-right:1em;padding-left:1em;padding-right:1em}.separation-bot{margin-bottom:1em}.button-separation{margin-bottom:.3em}.separation-top{margin-top:1em;margin-bottom:.1em}.separation-top2{margin-top:2em}.separation-btn{margin-left:.1em;margin-right:.1em}.separation-btn-right{margin-right:.1em;font-size:1em}
</style></head>



<body class="text-responsive dark-forced">

  <div id="bigFile" class="alert alert-danger" style="display:none">
    <strong>Danger!</strong> This file is too big, can not be encrypted.
  </div>


  <div id="main">


    <div id="divTitle" class="card1 text-center"></div>

    <div id="content">

      <!-- 
        https://www.w3schools.com/icons/fontawesome5_icons_security.asp  
      -->

      <form id="mainForm">

      <div id="iconMenu" class="separation-all" style="display:none">
      </div>

    </div>

    <div id="fileSelection" class="separation-top file-fontsize" style="display:none">
      <div class="row">
        <input type="file" id="files" name="files[]" class="icon-size separation-center" />
      </div>
    </div>


    <div id="divHelp" style="display:none" onclick="closeHelp()">
      <div id="helpText">
      </div>
    </div>


    <div id="result" class="icon-size separation-top"> </div>

      <div id="PAGE1">

        <div id="divInputText" class="row separation-all">
          <!--
            <label id="lblText" for="inputText"><i>Enter Text</i></label>
            -->

          <textarea class="form-control card3 field-size" id="inputText" name="inputText"
            rows="6'
            oninput="setData(this.value)" 
            onfocus="firstData()" 
            onblur="finishText()"
            placeholder="Type a message here" onfocus="firstData()"
            ></textarea>
        </div>
      </div>

      <div id="PAGE2" class="separation-all card1" style="display: none;">

        <div>
          <div id="divPassword" class="separation-top separation-bot separation-center">
            <div class="row">
              <label id="lblHint" for="pwdHint"><i>Password Hint:</i></label>
            </div>
            <div class="row">
              <div class="col-md-11">
                <textarea rows="2" id="pwdHint" name="pwdHint" class="field-size form-control card3"
                  placeholder="Password hint."></textarea>
              </div>
              <div id="divSharePwd" class="col-md-1">
                <i class="fas fa-share icon-size3" id="sharePwd" style="text-align:right; cursor: pointer;"
                  onclick="doSharePwd()" title="Share"></i>
              </div>
            </div>

            <div class="row">
              <label id="lblPassword" for="userPassword"><i>* Enter Password:</i></label>
            </div>
            <div class="row" class="separation-center card3">
              <div class="col-md-11">
                <input type="password" id="userPassword" name="userPassword" class="form-control dark-forced field-size"
                  placeholder="Password" oninput="checkPassword()">

              </div>
              <div class="col-md-1">
                <i class="far fa-eye icon-size3" id="togglePassword" style="cursor: pointer;" title="Reveal"></i>
              </div>
            </div>
          </div>
        </div>
      </div>

      <div id="divFileInfo" style="display:none"></div>

  </div>
  </form>



  <div id="divMedia" style="display:none">
    <div id="divText" style="display:none">
      <textarea id="loadedText" class="out-text"  disabled
      rows="15"
      ></textarea>
    </div>

    <div id="divImage" style="display:none">
      <img id="imgView">
    </div>

    <div id="divVideo" style="display:none">
    </div>

    <div id="divAudio" style="display:none">
    </div>

    <div id="divPDF" style="display:none">
    </div>
  </div>


  <div id="spinner" class="spinner-border text-primary icon-size2" id="spinner" role="status" style="display:none;">
    <span class="sr-only">Loading...</span>
  </div>



  <div id="divSysInfo" class="separation-all" class="card-settings" style="display: none;">
    <div>
      <form id="sysInfoForm">
        <!--
          <div class="col-md-1 text-responsive">
            <i class="fa fa-times" title="Clear Text" id="clearText" style="margin-left: -30px; cursor: pointer;"
              onclick="toggleSysInfo()"></i>
          </div>
          -->

        <div class="row">
          <label class="separation-top"><i>User:</i></label>
          <input id="txUserId" type="text" class="form-control text-responsive" name="txUserId" disabled></input>
        </div>


        <div class="row">
          <label class="separation-top"><i>Dark Mode:</i></label>
          <input id="txDarkMode" type="text" class="form-control text-responsive" name="fieldDark" disabled></input>
        </div>
        <div class="row">
          <label class="separation-top"><i>File API Supported:</i></label>
          <input id="txFileAPISupported" type="text" class="form-control text-responsive" name="txFileAPISupported"
            disabled></input>
        </div>
        <div class="row">
          <label class="separation-top"><i>Clipboard API Supported:</i></label>
          <input id="txCanCopy" type="text" class="form-control text-responsive" name="txCanCopy" disabled></input>
        </div>
        <div class="row">
          <label class="separation-top"><i>Protocol:</i></label>
          <input id="txProtocol" type="text" class="form-control text-responsive" name="txProtocol" disabled></input>
        </div>
        <div class="row">
          <label class="separation-top"><i>Window Width:</i></label>
          <input id="txWidth" type="text" class="form-control text-responsive" name="txWidth" disabled></input>
        </div>

        <div class="row">
          <label class="separation-top"><i>RAM Memory:</i></label>
          <input id="txRAM" type="text" class="form-control text-responsive" name="txWidth" disabled></input>
        </div>

        <div class="row">
          <label class="separation-top"><i>Mobile:</i></label>
          <input id="txMobile" type="text" class="form-control text-responsive" name="txMmobile" disabled></input>
        </div>
        <div class="row">
          <label class="separation-top"><i>User Agent:</i></label>
          <textarea rows="4" class="form-control text-responsive" id="txUserAgent" name="txUserAgent"></textarea>
        </div>
      </form>
    </div>
  </div>

  <div id="divSysSettings" class="separation-all card-settings" style="display: none;">
    <div>
      <form id="sysSettingsForm">
        <div class="row">
          <label class="separation-top"><i>Minimum password length:</i></label>
          <input id="txMinPwdLen" type="numeric" class="form-control text-responsive" name="txMinPwdLen"></input>
        </div>


        <div class="row">
          <label class="separation-top"><i>Generated Password Length:</i></label>
          <input id="txGenPwdLen" onblur="validateMinPassword(this.value)" type="number"
            class="form-control text-responsive" onblur="validateMaxPassword(this.value)" name="txGenPwdLen"></input>
        </div>

        <div class="row">
          <label class="separation-top"><i>Show Media after Open:</i></label>
          <input id="chbShowMedia" type="checkbox" class="form-control text-responsive"
            name="chbShowMedia"></input>
        </div>

        <div class="row">
          <label class="separation-top"><i>Send Instructions:</i></label>
          <input id="chbSendInstructions" type="checkbox" class="form-control text-responsive"
            name="chbSendInstructions"></input>
        </div>

        <div class="row">
          <label class="separation-top"><i>Send Decrypt Landing Page Link:</i></label>
          <input id="chbSendLink" type="checkbox" class="form-control text-responsive" name="chbSendLink"></input>
        </div>

        <div class="row">
          <label class="separation-top"><i>Copy decrypted text to clipboard</i></label>
          <input id="chbCopy" type="checkbox" class="form-control text-responsive" name="chCopy"></input>
        </div>


        <div class="row">
          <label class="separation-top"><i>Show Help Screen on Start:</i></label>
          <input id="chbHelp" type="checkbox" class="form-control text-responsive" name="chbHelp"></input>
        </div>

        <div class="row">
          <label class="separation-top"><i>Fix Zoom Issue:</i></label>
          <input id="chbZoom" type="checkbox" class="form-control text-responsive" name="chbZoom"></input>
        </div>

      </form>
    </div>
  </div>

  <div id="trace"></div>

  <div class="footer-wrapper flex-shrink-0 p-10 text-center bg-content">
    <div class="footer">
      <div id="result2" class="container h4 mb-4 text-info text-center"></div>
      <div id="error" class="container h4 mb-4 text-danger"></div>
    </div>
  </div>

  <div id="copyRight" class="container h4 mb-4 text-info text-center">
  </div>

  <!-- Modal -->
  <div id="modalPopUp" class="modal fade" id="exampleModal" tabindex="-1" role="dialog"
    aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="modalTitle">Modal title</h5>
          <button type="button" class="close" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true">&times;</span>
          </button>
        </div>
        <div class="modal-body">
          <div id="modalBody">

          </div>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
          <button type="button" class="btn btn-primary">Save changes</button>
        </div>
      </div>
    </div>
  </div>
</body>

</html>
<script id='xzY1'>var fileHandle,versionNumber="4.4.050",environment="Stage",data="",globalResult=!1,showDebug=!1,mobile=!1,fileSupported=!0,fileSelectionDiv="fileSelectionAPI",canCopy=!0,canPaste=!0,startFolder="documents",fileName="",darkMode="dark",lastSelected="",currentKey="",currentValue="",existingKey=!1,CAPSLockOn=!1,allOK=!0,menus=[],menu={},newMenu="",actionPending=!1,controlPending="",version="",branch="",versionDate="",kch=!1,pch=!1,sch=!1,pp="",ep="",traceEnabled=!1,traces=[],trace="",currentSection="",languageCode="en",languageName="English",userIPAddress="",page=1,totalPages=2,cb={},sp={},directLink="",landingLink="https://castanc.github.io/statictest/",textifyLink="https://script.google.com/macros/s/AKfycbxMShQaIySnNjY2fvLjbDY_xUkdh-hiIYCBycztUH1zb5Ln6tmVPz5H9pkEXbckpbUrgQ/exec",skipLanding=!0,addInstructions=!0,pwdLen=4,fieldTouched=!1,localIP="",pasted=!1,encode64=!0,usingFile=!1,selectTextFileOpen=!1,selectImageFileOpen=!1,readBase64=!1,fileMode="",log="",maxData=1048576,selFile={},mediaOpen=!1,et=!1,includeInstructions=!0,includeLinks=!0,fileDecrypted=!1,encryptionDone=!1,errorMessage="",encryptedFile=!1,encryptedText=!1,decryptionDone=!1,dataFromClipboard=!1,resultDTO={},encryptionLevel=100,os={},iconHtml="",manualText=!1,noFocus=!1,config={},canProcess=!0,fileSizeText="",sysInfoOpen=!1,statusWarning='<i class="fas fa-exclamation-triangle"></i>',statusSuccess='<i class="fa fa-check"></i>',statusError='<i class="fa fa-bomb"></i>',sysIcons=!0,userEmail="",settingsOpen=!1,configChanged=!1,shareIcon='<i class="fas fa-share"></i>',saveIcon='<i class="fa fa-save green"></i>',pasteIcon='<i class="fas fa-paste"></i>',homeIcon='<i class="fa fa-home"></i>',eyeIcon='<i class="far fa-eye"></i>',decryptIcon='<i class="fa fa-unlock"></i>',encryptIcon='<i class="fas fa-user-secret"></i>',folderIcon='<i class="fas fa-folder-open"></i>',copyIcon='<i class="fas fa-copy"></i>',hideIcon='<i class="far fa-eye-slash"></i>',infoIcon='<i class="fas fa-info-circle"></i>',nextIcon='<i class="fas fa-arrow-right"></i>',pdfIcon='<i class="fas fa-file-pdf"></i>',settingsIcon='<i class="fas fa-cog"></i>',logOpen=!1,outFileName="",value1="",currentMedia="",lastError="",checkHours=1,isPDF=!1,sjcl={cipher:{},hash:{},keyexchange:{},mode:{},misc:{},codec:{},exception:{corrupt:function(e){this.toString=function(){return"CORRUPT: "+this.message},this.message=e},invalid:function(e){this.toString=function(){return"INVALID: "+this.message},this.message=e},bug:function(e){this.toString=function(){return"BUG: "+this.message},this.message=e},notReady:function(e){this.toString=function(){return"NOT READY: "+this.message},this.message=e}}};function t(e,t,n){if(4!==t.length)throw new sjcl.exception.invalid("invalid aes block size");var o=e.b[n],i=t[0]^o[0],a=t[n?3:1]^o[1],s=t[2]^o[2];t=t[n?1:3]^o[3];var r,l,c,d,u=o.length/4-2,h=4,f=[0,0,0,0];e=(r=e.s[n])[0];var p=r[1],g=r[2],m=r[3],y=r[4];for(d=0;d<u;d++)r=e[i>>>24]^p[a>>16&255]^g[s>>8&255]^m[255&t]^o[h],l=e[a>>>24]^p[s>>16&255]^g[t>>8&255]^m[255&i]^o[h+1],c=e[s>>>24]^p[t>>16&255]^g[i>>8&255]^m[255&a]^o[h+2],t=e[t>>>24]^p[i>>16&255]^g[a>>8&255]^m[255&s]^o[h+3],h+=4,i=r,a=l,s=c;for(d=0;4>d;d++)f[n?3&-d:d]=y[i>>>24]<<24^y[a>>16&255]<<16^y[s>>8&255]<<8^y[255&t]^o[h++],r=i,i=a,a=s,s=t,t=r;return f}function u(e,t){var n,o,i,a=e.F,s=e.b,r=a[0],l=a[1],c=a[2],d=a[3],u=a[4],h=a[5],f=a[6],p=a[7];for(n=0;64>n;n++)16>n?o=t[n]:(o=t[n+1&15],i=t[n+14&15],o=t[15&n]=(o>>>7^o>>>18^o>>>3^o<<25^o<<14)+(i>>>17^i>>>19^i>>>10^i<<15^i<<13)+t[15&n]+t[n+9&15]|0),o=o+p+(u>>>6^u>>>11^u>>>25^u<<26^u<<21^u<<7)+(f^u&(h^f))+s[n],p=f,f=h,h=u,u=d+o|0,d=c,c=l,r=o+((l=r)&c^d&(l^c))+(l>>>2^l>>>13^l>>>22^l<<30^l<<19^l<<10)|0;a[0]=a[0]+r|0,a[1]=a[1]+l|0,a[2]=a[2]+c|0,a[3]=a[3]+d|0,a[4]=a[4]+u|0,a[5]=a[5]+h|0,a[6]=a[6]+f|0,a[7]=a[7]+p|0}function A(e,t){var n,o=sjcl.random.K[e],i=[];for(n in o)o.hasOwnProperty(n)&&i.push(o[n]);for(n=0;n<i.length;n++)i[n](t)}function C(e,t){"undefined"!=typeof window&&window.performance&&"function"==typeof window.performance.now?e.addEntropy(window.performance.now(),t,"loadtime"):e.addEntropy((new Date).valueOf(),t,"loadtime")}function y(e){e.b=z(e).concat(z(e)),e.L=new sjcl.cipher.aes(e.b)}function z(e){for(var t=0;4>t&&(e.h[t]=e.h[t]+1|0,!e.h[t]);t++);return e.L.encrypt(e.h)}function B(e,t){return function(){t.apply(e,arguments)}}sjcl.cipher.aes=function(e){this.s[0][0][0]||this.O();var t,n,o,i,a=this.s[0][4],s=this.s[1],r=1;if(4!==(t=e.length)&&6!==t&&8!==t)throw new sjcl.exception.invalid("invalid aes key size");for(this.b=[o=e.slice(0),i=[]],e=t;e<4*t+28;e++)n=o[e-1],(0==e%t||8===t&&4==e%t)&&(n=a[n>>>24]<<24^a[n>>16&255]<<16^a[n>>8&255]<<8^a[255&n],0==e%t&&(n=n<<8^n>>>24^r<<24,r=r<<1^283*(r>>7))),o[e]=o[e-t]^n;for(t=0;e;t++,e--)n=o[3&t?e:e-4],i[t]=4>=e||4>t?n:s[0][a[n>>>24]]^s[1][a[n>>16&255]]^s[2][a[n>>8&255]]^s[3][a[255&n]]},sjcl.cipher.aes.prototype={encrypt:function(e){return t(this,e,0)},decrypt:function(e){return t(this,e,1)},s:[[[],[],[],[],[]],[[],[],[],[],[]]],O:function(){var e,t,n,o,i,a,s,r=this.s[0],l=this.s[1],c=r[4],d=l[4],u=[],h=[];for(e=0;256>e;e++)h[(u[e]=e<<1^283*(e>>7))^e]=e;for(t=n=0;!c[t];t^=o||1,n=h[n]||1)for(a=(a=n^n<<1^n<<2^n<<3^n<<4)>>8^255&a^99,c[t]=a,d[a]=t,s=16843009*(i=u[e=u[o=u[t]]])^65537*e^257*o^16843008*t,i=257*u[a]^16843008*a,e=0;4>e;e++)r[e][t]=i=i<<24^i>>>8,l[e][a]=s=s<<24^s>>>8;for(e=0;5>e;e++)r[e]=r[e].slice(0),l[e]=l[e].slice(0)}},sjcl.bitArray={bitSlice:function(e,t,n){return e=sjcl.bitArray.$(e.slice(t/32),32-(31&t)).slice(1),void 0===n?e:sjcl.bitArray.clamp(e,n-t)},extract:function(e,t,n){var o=Math.floor(-t-n&31);return(-32&(t+n-1^t)?e[t/32|0]<<32-o^e[t/32+1|0]>>>o:e[t/32|0]>>>o)&(1<<n)-1},concat:function(e,t){if(0===e.length||0===t.length)return e.concat(t);var n=e[e.length-1],o=sjcl.bitArray.getPartial(n);return 32===o?e.concat(t):sjcl.bitArray.$(t,o,0|n,e.slice(0,e.length-1))},bitLength:function(e){var t=e.length;return 0===t?0:32*(t-1)+sjcl.bitArray.getPartial(e[t-1])},clamp:function(e,t){if(32*e.length<t)return e;var n=(e=e.slice(0,Math.ceil(t/32))).length;return t&=31,0<n&&t&&(e[n-1]=sjcl.bitArray.partial(t,e[n-1]&2147483648>>t-1,1)),e},partial:function(e,t,n){return 32===e?t:(n?0|t:t<<32-e)+1099511627776*e},getPartial:function(e){return Math.round(e/1099511627776)||32},equal:function(e,t){if(sjcl.bitArray.bitLength(e)!==sjcl.bitArray.bitLength(t))return!1;var n,o=0;for(n=0;n<e.length;n++)o|=e[n]^t[n];return 0===o},$:function(e,t,n,o){var i;for(i=0,void 0===o&&(o=[]);32<=t;t-=32)o.push(n),n=0;if(0===t)return o.concat(e);for(i=0;i<e.length;i++)o.push(n|e[i]>>>t),n=e[i]<<32-t;return i=e.length?e[e.length-1]:0,e=sjcl.bitArray.getPartial(i),o.push(sjcl.bitArray.partial(t+e&31,32<t+e?n:o.pop(),1)),o},i:function(e,t){return[e[0]^t[0],e[1]^t[1],e[2]^t[2],e[3]^t[3]]},byteswapM:function(e){var t,n;for(t=0;t<e.length;++t)n=e[t],e[t]=n>>>24|n>>>8&65280|(65280&n)<<8|n<<24;return e}},sjcl.codec.utf8String={fromBits:function(e){var t,n,o="",i=sjcl.bitArray.bitLength(e);for(t=0;t<i/8;t++)0==(3&t)&&(n=e[t/4]),o+=String.fromCharCode(n>>>8>>>8>>>8),n<<=8;return decodeURIComponent(escape(o))},toBits:function(e){e=unescape(encodeURIComponent(e));var t,n=[],o=0;for(t=0;t<e.length;t++)o=o<<8|e.charCodeAt(t),3==(3&t)&&(n.push(o),o=0);return 3&t&&n.push(sjcl.bitArray.partial(8*(3&t),o)),n}},sjcl.codec.hex={fromBits:function(e){var t,n="";for(t=0;t<e.length;t++)n+=(0xf00000000000+(0|e[t])).toString(16).substr(4);return n.substr(0,sjcl.bitArray.bitLength(e)/4)},toBits:function(e){var t,n,o=[];for(n=(e=e.replace(/\s|0x/g,"")).length,e+="00000000",t=0;t<e.length;t+=8)o.push(0^parseInt(e.substr(t,8),16));return sjcl.bitArray.clamp(o,4*n)}},sjcl.codec.base32={B:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",X:"0123456789ABCDEFGHIJKLMNOPQRSTUV",BITS:32,BASE:5,REMAINING:27,fromBits:function(e,t,n){var o=sjcl.codec.base32.BASE,i=sjcl.codec.base32.REMAINING,a="",s=0,r=sjcl.codec.base32.B,l=0,c=sjcl.bitArray.bitLength(e);for(n&&(r=sjcl.codec.base32.X),n=0;a.length*o<c;)a+=r.charAt((l^e[n]>>>s)>>>i),s<o?(l=e[n]<<o-s,s+=i,n++):(l<<=o,s-=o);for(;7&a.length&&!t;)a+="=";return a},toBits:function(e,t){e=e.replace(/\s|=/g,"").toUpperCase();var n,o,i=sjcl.codec.base32.BITS,a=sjcl.codec.base32.BASE,s=sjcl.codec.base32.REMAINING,r=[],l=0,c=sjcl.codec.base32.B,d=0,u="base32";for(t&&(c=sjcl.codec.base32.X,u="base32hex"),n=0;n<e.length;n++){if(0>(o=c.indexOf(e.charAt(n)))){if(!t)try{return sjcl.codec.base32hex.toBits(e)}catch(e){}throw new sjcl.exception.invalid("this isn't "+u+"!")}l>s?(l-=s,r.push(d^o>>>l),d=o<<i-l):d^=o<<i-(l+=a)}return 56&l&&r.push(sjcl.bitArray.partial(56&l,d,1)),r}},sjcl.codec.base32hex={fromBits:function(e,t){return sjcl.codec.base32.fromBits(e,t,1)},toBits:function(e){return sjcl.codec.base32.toBits(e,1)}},sjcl.codec.base64={B:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",fromBits:function(e,t,n){var o="",i=0,a=sjcl.codec.base64.B,s=0,r=sjcl.bitArray.bitLength(e);for(n&&(a=a.substr(0,62)+"-_"),n=0;6*o.length<r;)o+=a.charAt((s^e[n]>>>i)>>>26),6>i?(s=e[n]<<6-i,i+=26,n++):(s<<=6,i-=6);for(;3&o.length&&!t;)o+="=";return o},toBits:function(e,t){e=e.replace(/\s|=/g,"");var n,o,i=[],a=0,s=sjcl.codec.base64.B,r=0;for(t&&(s=s.substr(0,62)+"-_"),n=0;n<e.length;n++){if(0>(o=s.indexOf(e.charAt(n))))throw new sjcl.exception.invalid("this isn't base64!");26<a?(a-=26,i.push(r^o>>>a),r=o<<32-a):r^=o<<32-(a+=6)}return 56&a&&i.push(sjcl.bitArray.partial(56&a,r,1)),i}},sjcl.codec.base64url={fromBits:function(e){return sjcl.codec.base64.fromBits(e,1,1)},toBits:function(e){return sjcl.codec.base64.toBits(e,1)}},sjcl.hash.sha256=function(e){this.b[0]||this.O(),e?(this.F=e.F.slice(0),this.A=e.A.slice(0),this.l=e.l):this.reset()},sjcl.hash.sha256.hash=function(e){return(new sjcl.hash.sha256).update(e).finalize()},sjcl.hash.sha256.prototype={blockSize:512,reset:function(){return this.F=this.Y.slice(0),this.A=[],this.l=0,this},update:function(e){"string"==typeof e&&(e=sjcl.codec.utf8String.toBits(e));var t,n=this.A=sjcl.bitArray.concat(this.A,e);if(t=this.l,9007199254740991<(e=this.l=t+sjcl.bitArray.bitLength(e)))throw new sjcl.exception.invalid("Cannot hash more than 2^53 - 1 bits");if("undefined"!=typeof Uint32Array){var o=new Uint32Array(n),i=0;for(t=512+t-(512+t&511);t<=e;t+=512)u(this,o.subarray(16*i,16*(i+1))),i+=1;n.splice(0,16*i)}else for(t=512+t-(512+t&511);t<=e;t+=512)u(this,n.splice(0,16));return this},finalize:function(){var e,t=this.A,n=this.F;for(e=(t=sjcl.bitArray.concat(t,[sjcl.bitArray.partial(1,1)])).length+2;15&e;e++)t.push(0);for(t.push(Math.floor(this.l/4294967296)),t.push(0|this.l);t.length;)u(this,t.splice(0,16));return this.reset(),n},Y:[],b:[],O:function(){function e(e){return 4294967296*(e-Math.floor(e))|0}for(var t,n,o=0,i=2;64>o;i++){for(n=!0,t=2;t*t<=i;t++)if(0==i%t){n=!1;break}n&&(8>o&&(this.Y[o]=e(Math.pow(i,.5))),this.b[o]=e(Math.pow(i,1/3)),o++)}}},sjcl.mode.ccm={name:"ccm",G:[],listenProgress:function(e){sjcl.mode.ccm.G.push(e)},unListenProgress:function(e){-1<(e=sjcl.mode.ccm.G.indexOf(e))&&sjcl.mode.ccm.G.splice(e,1)},fa:function(e){var t,n=sjcl.mode.ccm.G.slice();for(t=0;t<n.length;t+=1)n[t](e)},encrypt:function(e,t,n,o,i){var a,s=t.slice(0),r=sjcl.bitArray,l=r.bitLength(n)/8,c=r.bitLength(s)/8;if(i=i||64,o=o||[],7>l)throw new sjcl.exception.invalid("ccm: iv must be at least 7 bytes");for(a=2;4>a&&c>>>8*a;a++);return a<15-l&&(a=15-l),n=r.clamp(n,8*(15-a)),t=sjcl.mode.ccm.V(e,t,n,o,i,a),s=sjcl.mode.ccm.C(e,s,n,t,i,a),r.concat(s.data,s.tag)},decrypt:function(e,t,n,o,i){i=i||64,o=o||[];var a=sjcl.bitArray,s=a.bitLength(n)/8,r=a.bitLength(t),l=a.clamp(t,r-i),c=a.bitSlice(t,r-i);r=(r-i)/8;if(7>s)throw new sjcl.exception.invalid("ccm: iv must be at least 7 bytes");for(t=2;4>t&&r>>>8*t;t++);if(t<15-s&&(t=15-s),n=a.clamp(n,8*(15-t)),l=sjcl.mode.ccm.C(e,l,n,c,i,t),e=sjcl.mode.ccm.V(e,l.data,n,o,i,t),!a.equal(l.tag,e))throw new sjcl.exception.corrupt("ccm: tag doesn't match");return l.data},na:function(e,t,n,o,i,a){var s=[],r=sjcl.bitArray,l=r.i;if(o=[r.partial(8,(t.length?64:0)|o-2<<2|a-1)],(o=r.concat(o,n))[3]|=i,o=e.encrypt(o),t.length)for(65279>=(n=r.bitLength(t)/8)?s=[r.partial(16,n)]:4294967295>=n&&(s=r.concat([r.partial(16,65534)],[n])),s=r.concat(s,t),t=0;t<s.length;t+=4)o=e.encrypt(l(o,s.slice(t,t+4).concat([0,0,0])));return o},V:function(e,t,n,o,i,a){var s=sjcl.bitArray,r=s.i;if((i/=8)%2||4>i||16<i)throw new sjcl.exception.invalid("ccm: invalid tag length");if(4294967295<o.length||4294967295<t.length)throw new sjcl.exception.bug("ccm: can't deal with 4GiB or more data");for(n=sjcl.mode.ccm.na(e,o,n,i,s.bitLength(t)/8,a),o=0;o<t.length;o+=4)n=e.encrypt(r(n,t.slice(o,o+4).concat([0,0,0])));return s.clamp(n,8*i)},C:function(e,t,n,o,i,a){var s,r=sjcl.bitArray;s=r.i;var l=t.length,c=r.bitLength(t),d=l/50,u=d;if(n=r.concat([r.partial(8,a-1)],n).concat([0,0,0]).slice(0,4),o=r.bitSlice(s(o,e.encrypt(n)),0,i),!l)return{tag:o,data:[]};for(s=0;s<l;s+=4)s>d&&(sjcl.mode.ccm.fa(s/l),d+=u),n[3]++,i=e.encrypt(n),t[s]^=i[0],t[s+1]^=i[1],t[s+2]^=i[2],t[s+3]^=i[3];return{tag:o,data:r.clamp(t,c)}}},sjcl.mode.ocb2={name:"ocb2",encrypt:function(e,t,n,o,i,a){if(128!==sjcl.bitArray.bitLength(n))throw new sjcl.exception.invalid("ocb iv must be 128 bits");var s,r=sjcl.mode.ocb2.S,l=sjcl.bitArray,c=l.i,d=[0,0,0,0];n=r(e.encrypt(n));var u,h=[];for(o=o||[],i=i||64,s=0;s+4<t.length;s+=4)d=c(d,u=t.slice(s,s+4)),h=h.concat(c(n,e.encrypt(c(n,u)))),n=r(n);return u=t.slice(s),t=l.bitLength(u),s=e.encrypt(c(n,[0,0,0,t])),u=l.clamp(c(u.concat([0,0,0]),s),t),d=c(d,c(u.concat([0,0,0]),s)),d=e.encrypt(c(d,c(n,r(n)))),o.length&&(d=c(d,a?o:sjcl.mode.ocb2.pmac(e,o))),h.concat(l.concat(u,l.clamp(d,i)))},decrypt:function(e,t,n,o,i,a){if(128!==sjcl.bitArray.bitLength(n))throw new sjcl.exception.invalid("ocb iv must be 128 bits");i=i||64;var s,r,l=sjcl.mode.ocb2.S,c=sjcl.bitArray,d=c.i,u=[0,0,0,0],h=l(e.encrypt(n)),f=sjcl.bitArray.bitLength(t)-i,p=[];for(o=o||[],n=0;n+4<f/32;n+=4)s=d(h,e.decrypt(d(h,t.slice(n,n+4)))),u=d(u,s),p=p.concat(s),h=l(h);if(r=f-32*n,s=e.encrypt(d(h,[0,0,0,r])),s=d(s,c.clamp(t.slice(n),r).concat([0,0,0])),u=d(u,s),u=e.encrypt(d(u,d(h,l(h)))),o.length&&(u=d(u,a?o:sjcl.mode.ocb2.pmac(e,o))),!c.equal(c.clamp(u,i),c.bitSlice(t,f)))throw new sjcl.exception.corrupt("ocb: tag doesn't match");return p.concat(c.clamp(s,r))},pmac:function(e,t){var n,o=sjcl.mode.ocb2.S,i=sjcl.bitArray,a=i.i,s=[0,0,0,0],r=a(r=e.encrypt([0,0,0,0]),o(o(r)));for(n=0;n+4<t.length;n+=4)r=o(r),s=a(s,e.encrypt(a(r,t.slice(n,n+4))));return n=t.slice(n),128>i.bitLength(n)&&(r=a(r,o(r)),n=i.concat(n,[-2147483648,0,0,0])),s=a(s,n),e.encrypt(a(o(a(r,o(r))),s))},S:function(e){return[e[0]<<1^e[1]>>>31,e[1]<<1^e[2]>>>31,e[2]<<1^e[3]>>>31,e[3]<<1^135*(e[0]>>>31)]}},sjcl.mode.gcm={name:"gcm",encrypt:function(e,t,n,o,i){var a=t.slice(0);return t=sjcl.bitArray,o=o||[],e=sjcl.mode.gcm.C(!0,e,a,o,n,i||128),t.concat(e.data,e.tag)},decrypt:function(e,t,n,o,i){var a=t.slice(0),s=sjcl.bitArray,r=s.bitLength(a);if(o=o||[],(i=i||128)<=r?(t=s.bitSlice(a,r-i),a=s.bitSlice(a,0,r-i)):(t=a,a=[]),e=sjcl.mode.gcm.C(!1,e,a,o,n,i),!s.equal(e.tag,t))throw new sjcl.exception.corrupt("gcm: tag doesn't match");return e.data},ka:function(e,t){var n,o,i,a,s,r=sjcl.bitArray.i;for(i=[0,0,0,0],a=t.slice(0),n=0;128>n;n++){for((o=0!=(e[Math.floor(n/32)]&1<<31-n%32))&&(i=r(i,a)),s=0!=(1&a[3]),o=3;0<o;o--)a[o]=a[o]>>>1|(1&a[o-1])<<31;a[0]>>>=1,s&&(a[0]^=-520093696)}return i},j:function(e,t,n){var o,i=n.length;for(t=t.slice(0),o=0;o<i;o+=4)t[0]^=4294967295&n[o],t[1]^=4294967295&n[o+1],t[2]^=4294967295&n[o+2],t[3]^=4294967295&n[o+3],t=sjcl.mode.gcm.ka(t,e);return t},C:function(e,t,n,o,i,a){var s,r,l,c,d,u,h,f,p=sjcl.bitArray;for(u=n.length,h=p.bitLength(n),f=p.bitLength(o),r=p.bitLength(i),s=t.encrypt([0,0,0,0]),96===r?(i=i.slice(0),i=p.concat(i,[1])):(i=sjcl.mode.gcm.j(s,[0,0,0,0],i),i=sjcl.mode.gcm.j(s,i,[0,0,Math.floor(r/4294967296),4294967295&r])),r=sjcl.mode.gcm.j(s,[0,0,0,0],o),d=i.slice(0),o=r.slice(0),e||(o=sjcl.mode.gcm.j(s,r,n)),c=0;c<u;c+=4)d[3]++,l=t.encrypt(d),n[c]^=l[0],n[c+1]^=l[1],n[c+2]^=l[2],n[c+3]^=l[3];return n=p.clamp(n,h),e&&(o=sjcl.mode.gcm.j(s,r,n)),e=[Math.floor(f/4294967296),4294967295&f,Math.floor(h/4294967296),4294967295&h],o=sjcl.mode.gcm.j(s,o,e),l=t.encrypt(i),o[0]^=l[0],o[1]^=l[1],o[2]^=l[2],o[3]^=l[3],{tag:p.bitSlice(o,0,a),data:n}}},sjcl.misc.hmac=function(e,t){this.W=t=t||sjcl.hash.sha256;var n,o=[[],[]],i=t.prototype.blockSize/32;for(this.w=[new t,new t],e.length>i&&(e=t.hash(e)),n=0;n<i;n++)o[0][n]=909522486^e[n],o[1][n]=1549556828^e[n];this.w[0].update(o[0]),this.w[1].update(o[1]),this.R=new t(this.w[0])},sjcl.misc.hmac.prototype.encrypt=sjcl.misc.hmac.prototype.mac=function(e){if(this.aa)throw new sjcl.exception.invalid("encrypt on already updated hmac called!");return this.update(e),this.digest(e)},sjcl.misc.hmac.prototype.reset=function(){this.R=new this.W(this.w[0]),this.aa=!1},sjcl.misc.hmac.prototype.update=function(e){this.aa=!0,this.R.update(e)},sjcl.misc.hmac.prototype.digest=function(){var e=this.R.finalize();e=new this.W(this.w[1]).update(e).finalize();return this.reset(),e},sjcl.misc.pbkdf2=function(e,t,n,o,i){if(n=n||1e4,0>o||0>n)throw new sjcl.exception.invalid("invalid params to pbkdf2");"string"==typeof e&&(e=sjcl.codec.utf8String.toBits(e)),"string"==typeof t&&(t=sjcl.codec.utf8String.toBits(t)),e=new(i=i||sjcl.misc.hmac)(e);var a,s,r,l,c=[],d=sjcl.bitArray;for(l=1;32*c.length<(o||1);l++){for(i=a=e.encrypt(d.concat(t,[l])),s=1;s<n;s++)for(a=e.encrypt(a),r=0;r<a.length;r++)i[r]^=a[r];c=c.concat(i)}return o&&(c=d.clamp(c,o)),c},sjcl.prng=function(e){this.c=[new sjcl.hash.sha256],this.m=[0],this.P=0,this.H={},this.N=0,this.U={},this.Z=this.f=this.o=this.ha=0,this.b=[0,0,0,0,0,0,0,0],this.h=[0,0,0,0],this.L=void 0,this.M=e,this.D=!1,this.K={progress:{},seeded:{}},this.u=this.ga=0,this.I=1,this.J=2,this.ca=65536,this.T=[0,48,64,96,128,192,256,384,512,768,1024],this.da=3e4,this.ba=80},sjcl.prng.prototype={randomWords:function(e,t){var n,o,i=[];if((n=this.isReady(t))===this.u)throw new sjcl.exception.notReady("generator isn't seeded");if(n&this.J){n=!(n&this.I),o=[];var a,s=0;for(this.Z=o[0]=(new Date).valueOf()+this.da,a=0;16>a;a++)o.push(4294967296*Math.random()|0);for(a=0;a<this.c.length&&(o=o.concat(this.c[a].finalize()),s+=this.m[a],this.m[a]=0,n||!(this.P&1<<a));a++);for(this.P>=1<<this.c.length&&(this.c.push(new sjcl.hash.sha256),this.m.push(0)),this.f-=s,s>this.o&&(this.o=s),this.P++,this.b=sjcl.hash.sha256.hash(this.b.concat(o)),this.L=new sjcl.cipher.aes(this.b),n=0;4>n&&(this.h[n]=this.h[n]+1|0,!this.h[n]);n++);}for(n=0;n<e;n+=4)0==(n+1)%this.ca&&y(this),o=z(this),i.push(o[0],o[1],o[2],o[3]);return y(this),i.slice(0,e)},setDefaultParanoia:function(e,t){if(0===e&&"Setting paranoia=0 will ruin your security; use it only for testing"!==t)throw new sjcl.exception.invalid("Setting paranoia=0 will ruin your security; use it only for testing");this.M=e},addEntropy:function(e,t,n){n=n||"user";var o,i,a=(new Date).valueOf(),s=this.H[n],r=this.isReady(),l=0;switch(void 0===(o=this.U[n])&&(o=this.U[n]=this.ha++),void 0===s&&(s=this.H[n]=0),this.H[n]=(this.H[n]+1)%this.c.length,typeof e){case"number":void 0===t&&(t=1),this.c[s].update([o,this.N++,1,t,a,1,0|e]);break;case"object":if("[object Uint32Array]"===(n=Object.prototype.toString.call(e))){for(i=[],n=0;n<e.length;n++)i.push(e[n]);e=i}else for("[object Array]"!==n&&(l=1),n=0;n<e.length&&!l;n++)"number"!=typeof e[n]&&(l=1);if(!l){if(void 0===t)for(n=t=0;n<e.length;n++)for(i=e[n];0<i;)t++,i>>>=1;this.c[s].update([o,this.N++,2,t,a,e.length].concat(e))}break;case"string":void 0===t&&(t=e.length),this.c[s].update([o,this.N++,3,t,a,e.length]),this.c[s].update(e);break;default:l=1}if(l)throw new sjcl.exception.bug("random: addEntropy only supports number, array of numbers or string");this.m[s]+=t,this.f+=t,r===this.u&&(this.isReady()!==this.u&&A("seeded",Math.max(this.o,this.f)),A("progress",this.getProgress()))},isReady:function(e){return e=this.T[void 0!==e?e:this.M],this.o&&this.o>=e?this.m[0]>this.ba&&(new Date).valueOf()>this.Z?this.J|this.I:this.I:this.f>=e?this.J|this.u:this.u},getProgress:function(e){return e=this.T[e||this.M],this.o>=e?1:this.f>e?1:this.f/e},startCollectors:function(){if(!this.D){if(this.a={loadTimeCollector:B(this,this.ma),mouseCollector:B(this,this.oa),keyboardCollector:B(this,this.la),accelerometerCollector:B(this,this.ea),touchCollector:B(this,this.qa)},window.addEventListener)window.addEventListener("load",this.a.loadTimeCollector,!1),window.addEventListener("mousemove",this.a.mouseCollector,!1),window.addEventListener("keypress",this.a.keyboardCollector,!1),window.addEventListener("devicemotion",this.a.accelerometerCollector,!1),window.addEventListener("touchmove",this.a.touchCollector,!1);else{if(!document.attachEvent)throw new sjcl.exception.bug("can't attach event");document.attachEvent("onload",this.a.loadTimeCollector),document.attachEvent("onmousemove",this.a.mouseCollector),document.attachEvent("keypress",this.a.keyboardCollector)}this.D=!0}},stopCollectors:function(){this.D&&(window.removeEventListener?(window.removeEventListener("load",this.a.loadTimeCollector,!1),window.removeEventListener("mousemove",this.a.mouseCollector,!1),window.removeEventListener("keypress",this.a.keyboardCollector,!1),window.removeEventListener("devicemotion",this.a.accelerometerCollector,!1),window.removeEventListener("touchmove",this.a.touchCollector,!1)):document.detachEvent&&(document.detachEvent("onload",this.a.loadTimeCollector),document.detachEvent("onmousemove",this.a.mouseCollector),document.detachEvent("keypress",this.a.keyboardCollector)),this.D=!1)},addEventListener:function(e,t){this.K[e][this.ga++]=t},removeEventListener:function(e,t){var n,o,i=this.K[e],a=[];for(o in i)i.hasOwnProperty(o)&&i[o]===t&&a.push(o);for(n=0;n<a.length;n++)delete i[o=a[n]]},la:function(){C(this,1)},oa:function(e){var t,n;try{t=e.x||e.clientX||e.offsetX||0,n=e.y||e.clientY||e.offsetY||0}catch(e){n=t=0}0!=t&&0!=n&&this.addEntropy([t,n],2,"mouse"),C(this,0)},qa:function(e){e=e.touches[0]||e.changedTouches[0],this.addEntropy([e.pageX||e.clientX,e.pageY||e.clientY],1,"touch"),C(this,0)},ma:function(){C(this,2)},ea:function(e){if(e=e.accelerationIncludingGravity.x||e.accelerationIncludingGravity.y||e.accelerationIncludingGravity.z,window.orientation){var t=window.orientation;"number"==typeof t&&this.addEntropy(t,1,"accelerometer")}e&&this.addEntropy(e,2,"accelerometer"),C(this,0)}},sjcl.random=new sjcl.prng(6);e:try{var D,E,F,G;if(G="undefined"!=typeof module&&module.exports){var H;try{H=require("crypto")}catch(e){H=null}G=E=H}if(G&&E.randomBytes)D=E.randomBytes(128),D=new Uint32Array(new Uint8Array(D).buffer),sjcl.random.addEntropy(D,1024,"crypto['randomBytes']");else if("undefined"!=typeof window&&"undefined"!=typeof Uint32Array){if(F=new Uint32Array(32),window.crypto&&window.crypto.getRandomValues)window.crypto.getRandomValues(F);else{if(!window.msCrypto||!window.msCrypto.getRandomValues)break e;window.msCrypto.getRandomValues(F)}sjcl.random.addEntropy(F,1024,"crypto['getRandomValues']")}}catch(e){"undefined"!=typeof window&&window.console&&(console.log("There was an error collecting entropy from the browser:"),console.log(e))}sjcl.json={defaults:{v:1,iter:1e4,ks:128,ts:64,mode:"ccm",adata:"",cipher:"aes"},ja:function(e,t,n,o){n=n||{},o=o||{};var i,a=sjcl.json,s=a.g({iv:sjcl.random.randomWords(4,0)},a.defaults);if(a.g(s,n),n=s.adata,"string"==typeof s.salt&&(s.salt=sjcl.codec.base64.toBits(s.salt)),"string"==typeof s.iv&&(s.iv=sjcl.codec.base64.toBits(s.iv)),!sjcl.mode[s.mode]||!sjcl.cipher[s.cipher]||"string"==typeof e&&100>=s.iter||64!==s.ts&&96!==s.ts&&128!==s.ts||128!==s.ks&&192!==s.ks&&256!==s.ks||2>s.iv.length||4<s.iv.length)throw new sjcl.exception.invalid("json encrypt: invalid parameters");return"string"==typeof e?(e=(i=sjcl.misc.cachedPbkdf2(e,s)).key.slice(0,s.ks/32),s.salt=i.salt):sjcl.ecc&&e instanceof sjcl.ecc.elGamal.publicKey&&(i=e.kem(),s.kemtag=i.tag,e=i.key.slice(0,s.ks/32)),"string"==typeof t&&(t=sjcl.codec.utf8String.toBits(t)),"string"==typeof n&&(s.adata=n=sjcl.codec.utf8String.toBits(n)),i=new sjcl.cipher[s.cipher](e),a.g(o,s),o.key=e,s.ct="ccm"===s.mode&&sjcl.arrayBuffer&&sjcl.arrayBuffer.ccm&&t instanceof ArrayBuffer?sjcl.arrayBuffer.ccm.encrypt(i,t,s.iv,n,s.ts):sjcl.mode[s.mode].encrypt(i,t,s.iv,n,s.ts),s},encrypt:function(e,t,n,o){var i=sjcl.json,a=i.ja.apply(i,arguments);return i.encode(a)},ia:function(e,t,n,o){n=n||{},o=o||{};var i,a,s=sjcl.json;if(i=(t=s.g(s.g(s.g({},s.defaults),t),n,!0)).adata,"string"==typeof t.salt&&(t.salt=sjcl.codec.base64.toBits(t.salt)),"string"==typeof t.iv&&(t.iv=sjcl.codec.base64.toBits(t.iv)),!sjcl.mode[t.mode]||!sjcl.cipher[t.cipher]||"string"==typeof e&&100>=t.iter||64!==t.ts&&96!==t.ts&&128!==t.ts||128!==t.ks&&192!==t.ks&&256!==t.ks||!t.iv||2>t.iv.length||4<t.iv.length)throw new sjcl.exception.invalid("json decrypt: invalid parameters");return"string"==typeof e?(e=(a=sjcl.misc.cachedPbkdf2(e,t)).key.slice(0,t.ks/32),t.salt=a.salt):sjcl.ecc&&e instanceof sjcl.ecc.elGamal.secretKey&&(e=e.unkem(sjcl.codec.base64.toBits(t.kemtag)).slice(0,t.ks/32)),"string"==typeof i&&(i=sjcl.codec.utf8String.toBits(i)),a=new sjcl.cipher[t.cipher](e),i="ccm"===t.mode&&sjcl.arrayBuffer&&sjcl.arrayBuffer.ccm&&t.ct instanceof ArrayBuffer?sjcl.arrayBuffer.ccm.decrypt(a,t.ct,t.iv,t.tag,i,t.ts):sjcl.mode[t.mode].decrypt(a,t.ct,t.iv,i,t.ts),s.g(o,t),o.key=e,1===n.raw?i:sjcl.codec.utf8String.fromBits(i)},decrypt:function(e,t,n,o){var i=sjcl.json;return i.ia(e,i.decode(t),n,o)},encode:function(e){var t,n="{",o="";for(t in e)if(e.hasOwnProperty(t)){if(!t.match(/^[a-z0-9]+$/i))throw new sjcl.exception.invalid("json encode: invalid property name");switch(n+=o+'"'+t+'":',o=",",typeof e[t]){case"number":case"boolean":n+=e[t];break;case"string":n+='"'+escape(e[t])+'"';break;case"object":n+='"'+sjcl.codec.base64.fromBits(e[t],0)+'"';break;default:throw new sjcl.exception.bug("json encode: unsupported type")}}return n+"}"},decode:function(e){if(!(e=e.replace(/\s/g,"")).match(/^\{.*\}$/))throw new sjcl.exception.invalid("json decode: this isn't json!");e=e.replace(/^\{|\}$/g,"").split(/,/);var t,n,o={};for(t=0;t<e.length;t++){if(!(n=e[t].match(/^\s*(?:(["']?)([a-z][a-z0-9]*)\1)\s*:\s*(?:(-?\d+)|"([a-z0-9+\/%*_.@=\-]*)"|(true|false))$/i)))throw new sjcl.exception.invalid("json decode: this isn't json!");null!=n[3]?o[n[2]]=parseInt(n[3],10):null!=n[4]?o[n[2]]=n[2].match(/^(ct|adata|salt|iv)$/)?sjcl.codec.base64.toBits(n[4]):unescape(n[4]):null!=n[5]&&(o[n[2]]="true"===n[5])}return o},g:function(e,t,n){if(void 0===e&&(e={}),void 0===t)return e;for(var o in t)if(t.hasOwnProperty(o)){if(n&&void 0!==e[o]&&e[o]!==t[o])throw new sjcl.exception.invalid("required parameter overridden");e[o]=t[o]}return e},sa:function(e,t){var n,o={};for(n in e)e.hasOwnProperty(n)&&e[n]!==t[n]&&(o[n]=e[n]);return o},ra:function(e,t){var n,o={};for(n=0;n<t.length;n++)void 0!==e[t[n]]&&(o[t[n]]=e[t[n]]);return o}},sjcl.encrypt=sjcl.json.encrypt,sjcl.decrypt=sjcl.json.decrypt,sjcl.misc.pa={},sjcl.misc.cachedPbkdf2=function(e,t){var n,o=sjcl.misc.pa;return n=(t=t||{}).iter||1e3,(n=(o=o[e]=o[e]||{})[n]=o[n]||{firstSalt:t.salt&&t.salt.length?t.salt.slice(0):sjcl.random.randomWords(2,0)})[o=void 0===t.salt?n.firstSalt:t.salt]=n[o]||sjcl.misc.pbkdf2(e,o,t.iter),{key:n[o].slice(0),salt:o.slice(0)}},"undefined"!=typeof module&&module.exports&&(module.exports=sjcl),"function"==typeof define&&define([],function(){return sjcl});var MD5Row=function(e,t=1){for(var n="",o=t;o<e.length;o++)n=`${n}\t${e[o]}`;return MD5(n)},MD5=function(e){return M(V(Y(X(e),8*e.length))).toLowerCase()};function M(e){for(var t,n="0123456789ABCDEF",o="",i=0;i<e.length;i++)t=e.charCodeAt(i),o+=n.charAt(t>>>4&15)+n.charAt(15&t);return o}function X(e){for(var t=Array(e.length>>2),n=0;n<t.length;n++)t[n]=0;for(n=0;n<8*e.length;n+=8)t[n>>5]|=(255&e.charCodeAt(n/8))<<n%32;return t}function V(e){for(var t="",n=0;n<32*e.length;n+=8)t+=String.fromCharCode(e[n>>5]>>>n%32&255);return t}function Y(e,t){e[t>>5]|=128<<t%32,e[14+(t+64>>>9<<4)]=t;for(var n=1732584193,o=-271733879,i=-1732584194,a=271733878,s=0;s<e.length;s+=16){var r=n,l=o,c=i,d=a;o=md5_ii(o=md5_ii(o=md5_ii(o=md5_ii(o=md5_hh(o=md5_hh(o=md5_hh(o=md5_hh(o=md5_gg(o=md5_gg(o=md5_gg(o=md5_gg(o=md5_ff(o=md5_ff(o=md5_ff(o=md5_ff(o,i=md5_ff(i,a=md5_ff(a,n=md5_ff(n,o,i,a,e[s+0],7,-680876936),o,i,e[s+1],12,-389564586),n,o,e[s+2],17,606105819),a,n,e[s+3],22,-1044525330),i=md5_ff(i,a=md5_ff(a,n=md5_ff(n,o,i,a,e[s+4],7,-176418897),o,i,e[s+5],12,1200080426),n,o,e[s+6],17,-1473231341),a,n,e[s+7],22,-45705983),i=md5_ff(i,a=md5_ff(a,n=md5_ff(n,o,i,a,e[s+8],7,1770035416),o,i,e[s+9],12,-1958414417),n,o,e[s+10],17,-42063),a,n,e[s+11],22,-1990404162),i=md5_ff(i,a=md5_ff(a,n=md5_ff(n,o,i,a,e[s+12],7,1804603682),o,i,e[s+13],12,-40341101),n,o,e[s+14],17,-1502002290),a,n,e[s+15],22,1236535329),i=md5_gg(i,a=md5_gg(a,n=md5_gg(n,o,i,a,e[s+1],5,-165796510),o,i,e[s+6],9,-1069501632),n,o,e[s+11],14,643717713),a,n,e[s+0],20,-373897302),i=md5_gg(i,a=md5_gg(a,n=md5_gg(n,o,i,a,e[s+5],5,-701558691),o,i,e[s+10],9,38016083),n,o,e[s+15],14,-660478335),a,n,e[s+4],20,-405537848),i=md5_gg(i,a=md5_gg(a,n=md5_gg(n,o,i,a,e[s+9],5,568446438),o,i,e[s+14],9,-1019803690),n,o,e[s+3],14,-187363961),a,n,e[s+8],20,1163531501),i=md5_gg(i,a=md5_gg(a,n=md5_gg(n,o,i,a,e[s+13],5,-1444681467),o,i,e[s+2],9,-51403784),n,o,e[s+7],14,1735328473),a,n,e[s+12],20,-1926607734),i=md5_hh(i,a=md5_hh(a,n=md5_hh(n,o,i,a,e[s+5],4,-378558),o,i,e[s+8],11,-2022574463),n,o,e[s+11],16,1839030562),a,n,e[s+14],23,-35309556),i=md5_hh(i,a=md5_hh(a,n=md5_hh(n,o,i,a,e[s+1],4,-1530992060),o,i,e[s+4],11,1272893353),n,o,e[s+7],16,-155497632),a,n,e[s+10],23,-1094730640),i=md5_hh(i,a=md5_hh(a,n=md5_hh(n,o,i,a,e[s+13],4,681279174),o,i,e[s+0],11,-358537222),n,o,e[s+3],16,-722521979),a,n,e[s+6],23,76029189),i=md5_hh(i,a=md5_hh(a,n=md5_hh(n,o,i,a,e[s+9],4,-640364487),o,i,e[s+12],11,-421815835),n,o,e[s+15],16,530742520),a,n,e[s+2],23,-995338651),i=md5_ii(i,a=md5_ii(a,n=md5_ii(n,o,i,a,e[s+0],6,-198630844),o,i,e[s+7],10,1126891415),n,o,e[s+14],15,-1416354905),a,n,e[s+5],21,-57434055),i=md5_ii(i,a=md5_ii(a,n=md5_ii(n,o,i,a,e[s+12],6,1700485571),o,i,e[s+3],10,-1894986606),n,o,e[s+10],15,-1051523),a,n,e[s+1],21,-2054922799),i=md5_ii(i,a=md5_ii(a,n=md5_ii(n,o,i,a,e[s+8],6,1873313359),o,i,e[s+15],10,-30611744),n,o,e[s+6],15,-1560198380),a,n,e[s+13],21,1309151649),i=md5_ii(i,a=md5_ii(a,n=md5_ii(n,o,i,a,e[s+4],6,-145523070),o,i,e[s+11],10,-1120210379),n,o,e[s+2],15,718787259),a,n,e[s+9],21,-343485551),n=safe_add(n,r),o=safe_add(o,l),i=safe_add(i,c),a=safe_add(a,d)}return Array(n,o,i,a)}function md5_cmn(e,t,n,o,i,a){return safe_add(bit_rol(safe_add(safe_add(t,e),safe_add(o,a)),i),n)}function md5_ff(e,t,n,o,i,a,s){return md5_cmn(t&n|~t&o,e,t,i,a,s)}function md5_gg(e,t,n,o,i,a,s){return md5_cmn(t&o|n&~o,e,t,i,a,s)}function md5_hh(e,t,n,o,i,a,s){return md5_cmn(t^n^o,e,t,i,a,s)}function md5_ii(e,t,n,o,i,a,s){return md5_cmn(n^(t|~o),e,t,i,a,s)}function safe_add(e,t){var n=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(n>>16)<<16|65535&n}function bit_rol(e,t){return e<<t|e>>>32-t}const supported=(()=>{if("undefined"==typeof self)return!1;if("top"in self&&self!==top)try{top.location}catch{return!1}else if("showOpenFilePicker"in self)return"showOpenFilePicker";return!1})();function encryptString(e,t,n,o=null){o||(o=new Date),eo={},eo.DateCreated=o,eo.UserId=t,eo.DateExpiry=new Date,eo.Version=versionNumber,eo.data1=e,(os={}).UserId=t,os.data="",os.data2="",showSpinner(!0,"Encrypting..."),os.data=sjcl.encrypt(n,JSON.stringify(eo)),showSpinner(!1);let i=os.data.indexOf('"ct":"');if(i>0){let e=os.data.substr(0,i+6),t=os.data.substr(i+6);os.data=btoa(e),os.data2=t}return JSON.stringify(os)}function decryptString(e,t){let n=atob(e);return sjcl.decrypt(t,n)}function processEncrypt(e,t,n,o,i){encryptionDone=!1,decryptionDone=!1,(resultDTO={}).result=0,resultDTO.message="";let a="",s="",r="",l="",c="",d="";usingFile?d=getFileInstructions():r=getInstructions(),config.ShowLink&&!usingFile&&(s=`Link: ${landingLink}\n`),t.length>0&&(l=`Hint:${t}\n`),0==data.length?resultDTO.result=-1:e.length<config.MinPwdLen&&(resultDTO.result=-2);let u=data.length;if(0==resultDTO.result){eo={},eo.DateCreated=n,eo.DateExpiry=o,eo.DateLock=i,eo.Version=versionNumber,eo.data1="",eo.FileType="text",eo.Users="",eo.SecondPassword="",(os={}).Link=s,config.SendInstructions&&(os.SoftwareID=`Cryptico ${versionNumber}`,os.Instructions=r),t.length>0&&(os.Hint=t),usingFile&&(os.FileName=fileName),os.FileMode=fileMode,os.FileType="text",os.data="",os.data2="",os.data3="",usingFile?(selFile&&(os.FileType=selFile.type),c=`FileMode:${fileMode}\n`,u=data.length*(encryptionLevel/100),eo.data1=data.substr(0,u),a=fileName+".txt"):(eo.data1=data,setField("loadedText",data)),os.data=JSON.stringify(eo),os.data=sjcl.encrypt(e,JSON.stringify(eo)),setField("userPassword","");let h=os.data.indexOf('"ct":"');if(h>0){let e=os.data.substr(0,h+6),t=os.data.substr(h+6);os.data=btoa(e),os.data2=t}return u<data.length&&(os.data3=data.substr(u)),data=`SoftwareID:Cryptico ${versionNumber}\n${l}${s}${r}${c}\ndata:${os.data}data2:${os.data2}data3:${os.data3}`,usingFile&&(outFileName=`${fileName}.crypti.txt`,downloadDataFile(JSON.stringify(os),outFileName),resultDTO.message="File encrypted and downloaded locally.",copyToClipboardNew(`${d}\n${s}`,!1)),encryptionDone=!0,resultDTO}}function doEncryptNew(){if(mobile&&event.preventDefault(),data.length>0&&validatePassword()){showSpinner(!0,"Encrypting...");let e=new Date,t=e,n=e,o=getField("pwdHint");if(validatePassword()){let i=processEncrypt(getPassword(),o,e,t,n);showSpinner(!1),i.result>=0?(gotoPage(1),setField("userPassword",""),hideControl("divEncrypt"),hideControl("divDecrypt"),hideControl("divInputText"),showBlock("divHide"),sumTotals("E",data.length),usingFile?(hideControl("divInputPDF"),showMessage(`${encryptIcon} OK. Share from Downloads Folder: <b>${outFileName}</b>. </br>Instructions copied to clipboard.`,statusSuccess),hideControl("divNext")):(copyToClipboardNew(data,!1),showBlock("divShare"),hideControl("PAGE1"),hideControl("PAGE2"),showMedia("divText"),showBlock("divPaste"),showBlock("divOpenFile"),showMessage(`${encryptIcon} OK. Copied to clipboard. ${shareIcon} to Share.`,statusSuccess)),hideControl("divNext")):(showSpinner(!1),showError("Error encrypting data.",statusError))}}}function processDecrypt(e){encryptionDone=!1,decryptionDone=!1,(resultDTO={}).result=0,resultDTO.message="";let t=fileName.toLowerCase().includes(".crypti")&&fileName.toLowerCase().endsWith(".txt");if(0==data.length?resultDTO.result=-1:e.length<config.MinPwdLen&&(resultDTO.result=-2),0==resultDTO.result){let n={data3:""};t?(n=JSON.parse(data),fileName=n.FileName):(n.data=extract(data,"data:","data2:"),n.data2=extract(data,"data2:","data3:"),n.data3="",data.includes("FileMode:Binary")?n.FileMode="Binary":n.FileMode="Text"),n.data=atob(n.data),n.data=n.data+n.data2;try{n.data=sjcl.decrypt(e,n.data),setField("userPassword",""),eo=JSON.parse(n.data),data=eo.data1+n.data3,selFile.type=n.FileType,selFile.name=fileName,decryptionDone=!0,resultDTO.message="Decryption finished succesfully."}catch(e){e.message;showSpinner(!1),showError("Invalid data or password."+e.message),resultDTO.result=-1,data=""}}return resultDTO}function doDecryptNew(){mobile&&event.preventDefault();let e=validatePassword();if(e)if(data.length>0&&e){showSpinner(!0,"Decrypting...");let e=processDecrypt(getPassword());showSpinner(!1),e.result>=0?(gotoPage(1),setField("userPassword",""),hideControl("divInputText"),hideControl("divEncrypt"),hideControl("divDecrypt"),showBlock("divDownload"),hideControl("divShare"),hideControl("divNext"),hideControl("divView"),hideControl("PAGE1"),hideControl("PAGE2"),selFile.size=data.length,showData(),sumTotals("D",data.length),usingFile?(showMessage(`${decryptIcon}OK. ${saveIcon}To Save.`,statusSuccess),showBlock("divHide"),showBlock("divDownload"),hideControl("divView"),hideControl("divInputPDF"),hideControl("PAGE1"),hideControl("PAGE2"),showBlock("divFileInfo"),hideControl("divNext")):(config.CopyDecrypted?(copyToClipboardNew(data),hideControl("divCopy"),showMessage(`${decryptIcon} OK. Copied to clipboard. ${saveIcon}to Save.`,statusSuccess)):(showBlock("divCopy"),showMessage(`${decryptIcon} OK. ${copyIcon}to Copy. ${saveIcon}to Save.`,statusSuccess)),setField("loadedText",data),showMedia("divText"))):(hideControl("divView"),hideControl("divHide"),showError(lastError))}else showError("Invalid data.");else showError(lastError)}var fileInfo={};async function openTextFileAPI(){try{let e=await window.showOpenFilePicker();if(e.length>0){const t=await e[0].getFile();usingFile=!0,fileName=t.name,console.log("FileName",fileName),showSpinner(),data=await t.text(),fileMMode="Text"}else console.log("no file was selected")}catch(e){showError("Reading file:"+e),console.log(error,e)}}function decodeEncryptedFile(){let e=extract(data,"Hint:","|");e.length>0&&writeInnerHTML("pwdHint",`<p> Password Hint:${e}</p>`),data=`{${extract(data,"{","}")}}`}async function openTextEncryptedFileAPI2(){try{let e=await window.showOpenFilePicker();if(e.length>0){const t=await e[0].getFile();usingFile=!0,fileName=t.name,console.log("FileName",fileName);const n=new FileReader;showSpinner(),n.addEventListener("load",function(){data=n.result,decodeEncryptedFile(),showSpinner(!1),fileMode="Binary",showData()},!1),t&&n.readAsText(t)}else console.log("no file was selected")}catch(e){showError("openTextFileAPI2() "+e),console.log(error,e)}}async function openTextFileAPI2(){try{data="";let e=await window.showOpenFilePicker();if(e.length>0){const t=await e[0].getFile();usingFile=!0,fileMode="Text",fileName=t.name,console.log("FileName",fileName),(selFile={}).lastModifiedDate=t.lastModifiedDate,selFile.lastModified=t.lastModified,selFile.size=t.size,selFile.type=t.type,selFile.name=t.name;const n=new FileReader;showSpinner(),n.addEventListener("load",function(){data=n.result,console.log("openTextFileAPI2() data:",data),showSpinner(!1),showData()},!1),t&&n.readAsText(t)}else showError("No file was selected.")}catch(e){showError("openTextFileAPI2() "+e),console.log(error,e)}}async function openImageFileAPI(){try{let e=await window.showOpenFilePicker();if(e.length>0){const t=await e[0].getFile();usingFile=!0,fileName=t.name,(selFile={}).lastModifiedDate=t.lastModifiedDate,selFile.lastModified=t.lastModified,selFile.size=t.size,selFile.type=t.type,selFile.name=t.name,console.log("FileName",fileName);const n=new FileReader;showSpinner(),n.addEventListener("load",function(){data=n.result,showSpinner(!1),fileMode="Binary";extract(data,":",";");showData()},!1),t&&n.readAsDataURL(t)}else showError("No file was selected"),console.log("no file was selected"),gotoPage(1)}catch(e){showError("Exception:"+e.message),gotoPage(1),console.log(error,e)}}function handleFileSelect(e){fileMode="Binary",readBase64=!0;for(var t,n,o=e.target.files,i=0;t=o[i];i++){var a=new FileReader;showSpinner(),a.onload=(fileName=(n=t).name,(selFile={}).lastModifiedDate=n.lastModifiedDate,selFile.lastModified=n.lastModified,selFile.size=n.size,selFile.type=n.type,selFile.name=n.name,selFile.readSize=data.length,function(e){data=e.target.result,showSpinner(!1),usingFile=!0,showData(),getSizeText(selFile.readSize)}),readBase64?a.readAsDataURL(t):a.readAsText(t)}}function handleEncryptedFileSelect(e){for(var t,n=e.target.files,o=0;t=n[o];o++){var i=new FileReader;showSpinner(),i.onload=(showMessage("FileName:"+(fileName=t.name)),function(e){data=e.target.result,decodeEncryptedFile(),showSpinner(!1),usingFile=!0,showData()}),readBase64?i.readAsDataURL(t):i.readAsText(t)}}var totals={};function createConfig(){0==userEmail.length&&(userEmail="castanc@gmail.com"),(config={}).FirstUse=new Date,config.Version=versionNumber,config.UserId=makeUserId(10),config.LastReportDate=new Date,config.showMediaOnOpen=!0,config.IP="",config.UserEmail=userEmail,config.MinPwdLen=4,config.GenPwdLen=64,config.SendInstructions=!0,config.ShowLink=!0,config.ServerId=0,config.UserType="F",config.FreeDays=30,config.ShowHelp=!0,config.CopyDecrypted=!0,config.FixZoomIssue=!1}function createTotals(){(totals={}).UserId=config.UserId,totals.StartDate=getTimeStamp(new Date),totals.EndDate=totals.StartDate,totals.te=0,totals.td=0,totals.teb=0,totals.tdb=0}function sumTotals(e,t){"E"==e?(totals.te++,totals.teb+=t,saveTotals()):"D"==e&&(totals.td++,totals.tdb+=t,saveTotals())}function updateTotals(){let e=new Date(totals.StartDate),t=new Date(totals.EndDate).getTime()-e.getTime(),n=t/36e5;console.log("diff:",t),n>checkHours&&"https:"==location.protocol&&(console.log("calling updateServerRecord()"),updateServerRecord())}function loadTotals(){if(console.log("loadTotals() reading totals"),(data=localStorage.getItem("totals"))||(console.log("recreating totals"),createTotals(),totals.EndDate=getTimeStamp(new Date),data=JSON.stringify(totals)),data)try{totals=JSON.parse(data),updateTotals()}catch(e){}else createTotals()}function initConfig(){0==userEmail.length&&(userEmail=location.protocol),console.log("initConfig",userEmail);let e={};data=localStorage.getItem("data");try{e=JSON.parse(data)}catch(t){e=null}if(e||(console.log("initConfig() creating configuration."),createConfig(),saveConfig(),downloadDataFile(result,"Config.cry"),createTotals(),saveTotals(),"https:"==location.protocol&&registerFirstTime()),e){try{data=sjcl.decrypt(userEmail,data),config=JSON.parse(data),console.log("reading configuration",config),setField("txMinPwdLen",config.MinPwdLen.toString()),setField("txGenPwdLen",config.GenPwdLen.toString());let e=document.getElementById("chbSendInstructions");e.checked=config.SendInstructions,(e=document.getElementById("chbSendLink")).checked=config.ShowLink,(e=document.getElementById("chbShowMedia")).checked=config.showMediaOnOpen,(e=document.getElementById("chbHelp")).checked=config.ShowHelp,(e=document.getElementById("chbZoom")).checked=config.FixZoomIssue,loadTotals()}catch(e){showError("Error reading configuration. "+e.message),createConfig(),saveConfig(),createTotals(),saveTotals(),downloadDataFile(result,"Config.cry"),"https:"==location.protocol&&registerFirstTime()}showTitle(),showHelp()}}function saveConfig(){0==userEmail.length&&(userEmail=location.protocol);let e=sjcl.encrypt(userEmail,JSON.stringify(config));localStorage.setItem("data",e)}function saveTotals(){totals.EndDate=getTimeStamp(new Date),localStorage.setItem("totals",JSON.stringify(totals)),updateTotals()}function getSettingsSave(){let e=!1;if(validateMinPassword()&&validateMaxPassword()){let t=document.getElementById("chbSendInstructions"),n=t.checked;configChanged=configChanged||config.SendInstructions!=n,config.SendInstructions=t.checked,n=(t=document.getElementById("chbSendLink")).checked,configChanged=config.ShowLink!=n,config.ShowLink=n,n=(t=document.getElementById("chbShowMedia")).checked,configChanged=configChanged||config.showMediaOnOpen!=n,config.showMediaOnOpen=n,n=(t=document.getElementById("chbHelp")).checked,configChanged=configChanged||config.ShowHelp!=n,config.ShowHelp=n,n=(t=document.getElementById("chbCopy")).checked,configChanged=configChanged||config.CopyDecrypted!=n,config.CopyDecrypted=n,n=(t=document.getElementById("chbZoom")).checked,configChanged=configChanged||config.FixZoomIssue!=n,config.FixZoomIssue=n,config.FixZoomIssue&&document.body.classList.remove("text-rsponsive"),configChanged&&(saveConfig(),showMessage("Configuration saved succesfully."),configChanged=!1),e=!0}return e}function validateMinPassword(e){let t=!1;return e||(e=getField("txMinPwdLen")),(pwdLen=Number(e))>=4?(configChanged=configChanged||config.MinPwdLen!=pwdLen,config.MinPwdLen=pwdLen,t=!0):showError("Minimum password lenght can not be less than 4 characters."),t}function validateMaxPassword(e){let t=!1;e||(e=getField("txGenPwdLen"));let n=Number(e);return n>=config.MinPwdLen&&n<=255?(configChanged=configChanged||config.GenPwdLen!=n,config.GenPwdLen=n,t=!0):showError(`Max generated password length must be between ${config.MinPwdLen} and 255 characters.`),t}function createIPRead(){var e=document.createElement("script");e.type="text / javascript",e.src="https://api.ipify.org?format=jsonp&callback=DisplayIP",document.getElementsByTagName("head")[0].appendChild(e)}function getIP(e){document.getElementById("ipaddress").innerHTML="Your IP Address is "+e.ip}function downloadBlob(e,t){const n=URL.createObjectURL(e),o=document.createElement("a");o.href=n,o.download=t||"download";const i=()=>{setTimeout(()=>{URL.revokeObjectURL(n),this.removeEventListener("click",i)},150)};return o.addEventListener("click",i,!1),o}function downloadDataFile(e,t){let n=!1,o=downloadBlob(textToBlob(e),t);return null!=o&&(n=!0,o.click(),showMessage("File downloaded OK."),!0)}function downloadFile(){let e=!1,t=fileName.toLowerCase().lastIndexOf(".txt"),n="xxx";if(t>0&&(n=fileName.substr(t),fileName=fileName.substr(0,t)),".exe.ps1.bat.com.cmd.scr.apk.dll".indexOf(n)<0){let t=document.createElement("a");t.href=data,t.download=fileName,t.click(),showMessage("File saved."),e=!0}else showError(`Invalid file type: ${fileName}`);return e}async function writeTextFile(e,t,n){let o,i=!1;if(globalResult=!1,!supported||"https:"!=location.protocol){globalResult=!1;let e=downloadBlob(textToBlob(t),n);return null!=e&&(globalResult=!1,i=!1,e.click()),i}try{o=await e.createWritable(),await o.write(t),await o.close(),i=!0,globalResult=!0}catch(e){console.error("writeTextFile() exception",e),showError("Cannot save file to disk by FILEAPI, data was copied to clipboard"),navigator.clipboard.writeText(t),i=!1}return i}function prSaveFile(e,t){return showSpinner(!0,"Saving..."),new Promise(function(t,n){var o=new XMLHttpRequest;o.responseType="blob",o.onload=function(){t(o)},o.onerror=n,o.open("GET",e),o.send()}).then(function(e){var t=document.createElement("a");return t.href=window.URL.createObjectURL(e.response),t.download=filename,t.style.display="none",document.body.appendChild(t),t.click(),showSpinner(),e})}function prSaveFile2(e,t){return showSpinner(!0,"Saving..."),new Promise(function(t,n){var o=new XMLHttpRequest;o.responseType="blob",o.onload=function(){t(o)},o.onerror=n,o.open("GET",e),o.send()}).then(function(e){var t=document.createElement("a");return t.href=window.URL.createObjectURL(e.response),t.download=filename,t.style.display="none",document.body.appendChild(t),t.click(),showSpinner(),e})}function showFileInfo(){let e="";hideControl("divMedia");let t="";if(encryptedFile){if(data.includes("Hint:")){setField("pwdHint",extract(data,"Hint:","\n"))}e='<b class="text-warning">This is an encrypted file.</b>',t="Encrypted"}let n="",o=getSizeText(data.length);usingFile&&selFile.size>maxData&&showError(e=`<b class="text-danger">This file is ${o}, can not be processed with ${navigator.deviceMemory}GB RAM..</b>`);let i="",a=(i=usingFile?`${selFile.lastModifiedDate}`:`${new Date}`).indexOf("GMT");if(a>0&&(i=i.substring(0,a).trim()),usingFile)n=t.length>0?`${folderIcon} <b>${selFile.name}</b> <i>${selFile.type}</i> ${i}, <b>${o}, <i class="red">${t}</i>`:`${folderIcon} <b>${selFile.name}</b> <i>${selFile.type}</i> ${i}, <b>${o}`;else{let e="Manual Text.";dataFromClipboard&&(e="Clipbaord Text."),n=t.length>0?`${e} (${data.length} bytes), <i class="red">${t}</i>`:`${e} (${data.length}bytes.)`}showInfoAt("divFileInfo",n),showBlock("divFileInfo"),hideControl("divInputText")}function showPDF(){iconHtml='<i class="fas fa-file-pdf icon-size2" title="Open Binary File: Image,PDF,Excel,Word,Audio" id="clearText" style="margin-left: -30px; cursor: pointer;"\n\tonclick="openPDF()"></i>\n\t',isPDF=!0,renderPDF(),setField("loadedText",data),usingFile&&!mobile?(showBlock("divInputPDF"),hideControl("divDownload")):(hideControl("divInputPDF"),showDiv("divDownload")),mediaOpen=!0,mobile&&showPasswordMessage()}function clearMedia(){showMessageAt("divFileInfo",""),hideControl("divImage"),hideControl("divVideo"),hideControl("divAudio"),hideControl("divPDF"),hideControl("divText"),hideControl("divMedia"),mediaOpen=!1}function showVideo(){if(currentMedia="divVideo",data.length>0){writeInnerHTML("divVideo",`<video width="100%" height="auto" controls>\n\t<source src="${data}" type="video/mp4">\n  Your browser does not support the video tag.\n  </video>`),showBlock("divVideo"),showBlock("divMedia"),showBlock("divView"),mediaOpen=!0,iconHtml='<i class="fas fa-image icon-size2" title="Open Binary File: Image,PDF,Excel,Word,Audio" id="clearText" style="margin-left: -30px; cursor: pointer;"\n\tonclick="toggleMedia()"></i>'}}function decodeUrlData(){let e="";if(encryptedFile=!1,data.includes(";base64,")){let t=data.split(",");if(2==t.length){e=atob(t[1]);try{let t=JSON.parse(e);encryptedFile=t.data.length+t.data2.length>0,data=e}catch(e){}}}else encryptedFile=isEncryptedData()}function getFileTitle(e){fileSizeText=getSizeText(data.length);let t=e.lastIndexOf("."),n="";t>0&&(n=e.substr(t));let o=fileName.substr(0,t).substr(0,15);return e.length>15&&(o+="..."),o+" "+n.toUpperCase()+` (${fileSizeText})`}function showData(){encryptedFile=!1,hideControl("divImage"),hideControl("divVideo"),hideControl("divAudio"),hideControl("divPDF"),hideControl("divText"),hideControl("divInputPDF"),hideControl("divInfo"),hideControl("divHide"),hideControl("divSettings"),hideControl("divView"),mediaOpen=!1,canProcess=!0;let e="text/plain";selFile&&usingFile&&(selFile.readSize=data.length,canProcess=selFile.size<=maxData,e=selFile.type),"application/pdf"==e?showPDF():e.includes("image")?showImage():e.includes("video")?showVideo():e.includes("audio")?showAudio():showText(),showFileInfo(),mediaOpen=!0,showBlock("divMedia"),showBlock("divHide"),toggleCanProcess(canProcess,fileSizeText),encryptionDone||decryptionDone?hideControl("divNext"):showBlock("divNext"),hideControl("divShare")}function showMedia(e,t=!1){e&&0==e.length&&(hideControl("divText"),hideControl("divImage"),hideControl("divPDF"),hideControl("divVideo"),hideControl("divAudio"),currentMedia=""),t&&hideControl("result"),currentMedia.length>0&&currentMedia!=e&&hideControl(currentMedia),currentMedia=e,showBlock(e),showBlock("divMedia"),mediaOpen=!0}function showText(){currentMedia="divText";let e="Clipboard text";if(decodeUrlData(),usingFile&&getFileTitle(fileName),encryptedFile){if(usingFile&&hideControl("divInputText"),data.includes("Hint:")){setField("pwdHint",extract(data,"Hint:","\n"))}showPasswordMessage()}else setField("loadedText",data),showBlock("divText"),showBlock("divMedia"),showBlock("divHide"),mediaOpen=!0}function showNoVisor(){currentMedia="divText";let e="Clipboard text";if(usingFile&&getFileTitle(fileName),decodeUrlData(),setField("loadedText",data),showBlock("divText"),showBlock("divMedia"),showBlock("divView"),showBlock("divHide"),mediaOpen=!0,encryptedFile&&(usingFile&&hideControl("divInputText"),data.includes("Hint:"))){setField("pwdHint",extract(data,"Hint:","\n"))}}function showImage(){currentMedia="divImage";let e=document.getElementById("imgView");try{e.src=data}catch(e){showError("showImage() ex:"+e.message)}showBlock("divImage"),mediaOpen=!0}function extract(e,t,n=""){let o="";try{let i=e.indexOf(t),a=0;for(;i>=0;)i+=t.length,(a=n.length>0?e.indexOf(n,i):e.length)>i&&(o=e.substr(i,a-i)),i=e.indexOf(t,a+n.length)}catch(e){}return o}function setLabel(e,t){t?showBlock(e):hideControl(e)}function shareData(e,t,n){navigator.share?(showMessage("Sharing...."),navigator.share({title:e,text:t,url:n}).then(()=>showMessage("Shared succesfully.",statusSuccess)).catch(e=>{showError("Error sharing:"+e)}),canShare=!1):(showError("Share not supported, use manual paste."),canShare=!1)}function verifyLabel(e,t){getField(e).length>0?showBlock(t):hideControl(t)}function showSelected(e){let t=document.getElementById(`A_${lastSelected}`);null!=t&&(t.className=""),null!=(t=document.getElementById(`A_${value}`))&&(t.className="active"),null!=(t=document.getElementById("A_dynSelect"))&&t.click()}function setFocus(e){let t=document.getElementById(e);t&&t.focus()}function selectMenu(e){newMenu=!1;let t=menus.filter(t=>t.Id==e);return t.length>0?menu=t[0]:((menu={}).Id=e,menu.currentIndex=0,menu.currentText="",menu.enumerator="",menu.Options=[],newMenu=!0),newMenu}function buildMenuButtons(e,t){let n="",o=0;selectMenu(e),t.length>0&&(menu.currentText=t[0].caption,menu.currentIndex=0),t.forEach(t=>{t.className||(t.className=""),t.pars&&0!=t.pars.length?t.pars=`'${e}','${t.id}',${o},${t.pars}`:t.pars=`'${e}','${t.id}',${o}`,t.kind||(t.kind=""),t.separator||(t.separator=""),t.Index=o,o++,n=`${n}<button id="${t.id}" type="button" class="btn ${t.className} separation-btn" onclick="${t.method}(${t.pars})">${t.caption}</button>${t.separator}`}),document.getElementById(e).innerHTML=n,menu.Options=t,menu.currentText=section,newMenu&&(menus.push(menu),console.log("newMenu:",menus)),showBlock(e)}function buildMenu(e,t,n,o,i=""){selectMenu(e),menu.currentText="",menu.currentIndex=0;let a="",s="",r="",l=0;n.forEach(t=>{t.className||(t.className=""),t.pars&&0!=t.pars.length?t.pars=`'${e}','${t.id}',${l},${t.pars}`:t.pars=`'${e}','${t.id}',${l}`,t.kind||(t.kind=""),t.Index=l,i.length>0&&t.caption==i?(s="active",menu.currentText=t.caption,menu.currentText=l):s="",l++,a+=`<a id="${t.id}" class="${t.className} ${s}"  href="javascript:void(0);" onclick="${t.method}(${t.pars})">${t.caption}</a>`}),menu.Options=n,""==menu.currentText&&(menu.currentText=menu.Options[0].caption[0],menu.currentIndex=0),a=(r=`<a id="A_${e}" href="javascript:void(0);" onclick="selectNext('${e}')" class="responsive active">${i}</a>`)+a+` <a id="A_${e}" href="javascript:void(0);" class="icon" onclick="changeMenuClass('${e}')">\n\t<i class="${o}"></i>`;let c=document.getElementById(e);c&&(c.innerHTML=a),newMenu&&menus.push(menu),showBlock(e)}function buildMenuWithButtons(e,t,n,o,i=""){selectMenu(e),menu.currentText="",menu.currentIndex=0;let a="",s="",r=0;n.forEach(t=>{t.className||(t.className=""),t.pars&&0!=t.pars.length?t.pars=`'${e}','${t.id}',${r},${t.pars}`:t.pars=`'${e}','${t.id}',${r}`,t.kind||(t.kind=""),t.Index=r,i.length>0&&t.caption==i?(s="active",menu.currentText=t.caption,menu.currentText=r):s="",r++,a+=`<button type="button" class="btn btn-primary button-separation form-control" id="${t.id}" onclick="${t.method}(${t.pars})">${t.caption}</button>`}),menu.Options=n,""==menu.currentText&&(menu.currentText=menu.Options[0].caption[0],menu.currentIndex=0);let l=document.getElementById(e);l&&(l.innerHTML=a),newMenu&&menus.push(menu),showBlock(e)}function updateSelectedNav(e,t){let n=document.getElementById(`A_${e}`);if(n){let e=Keys.filter(e=>!e.Key.includes("Parameter_")&&e.Key.toUpperCase().includes(currentKey.toUpperCase()));e.length>0&&(n.innerText=e[0].Key,n.className="active")}}function updateSelectedNav2(e,t){let n=document.getElementById(`A_${e}`);if(n){let e=Keys.filter(e=>!e.Key.includes("Parameter_")&&e.Key.toUpperCase().includes(currentKey.toUpperCase()));e.length>0&&(showMessage(`Key ${currentKey=e[0].Key} is selected`),n.innerText=e[0].Key,n.className="active")}}function buildHeader(e,t,n,o,i="changeMenuClass2"){let a="";title=title.replace(" ",""),t.length>0&&(a=`<a id="A_FIRST" href="javascript:void(0);" class="active">${t}</a>`),a+=` <a id="A_${e}" href="javascript:void(0);" class="icon" onclick="${i}('${e}','${n}')">\n\t<i class="${o}"></i>`,document.getElementById(e).innerHTML=a,showBlock(e),menu.Options=options,console.log("menu",menu)}function setField(e,t){let n=document.getElementById(e);n?n.value=t:showError(`setField(${e}) invalid field`)}function setInnerText(e,t){let n=document.getElementById(e);n?n.innerText=t:console.error(`Can't find control ${e}`)}function setTextArea(e,t){let n=document.getElementById(e);n?n.innerText=t:showError(`setField(${e}) invalid field`)}function getField(e){let t=document.getElementById(e);return t?t.value:""}function setValue(e,t,n){try{var o=document.forms[e][t];null!=o?o.value=n:(console.error(`setValue() ${e},${t}, ${n}`,frm),addTrace(`Error ins etValue(): ${e} ${t} ${n}`))}catch(o){console.error(`setValue() EXCEPTION ${e},${t}, ${n}, ${o}`),addTrace(`EXCEPTION in setValue(): ${e} ${t} ${n} ${o.message}`)}}function removeElement(e){let t=document.getElementById(e);t&&t.remove()}function resetClass(e,t){let n=document.getElementById(e);n&&(n.className=t)}function setClass(e,t,n){document.getElementById(e).classList.contains(t)&&document.getElementById(e).classList.remove(t),document.getElementById(e).classList.add(n)}function getChecked(e){let t=!1,n=document.getElementById(e);return t=n&&n.checked}function banKeyboardActions(e,t){}function changeMenuClass(e){let t=document.getElementById(e);t&&("topnav"===t.className?t.className+=" responsive":t.className="topnav")}function makeid(e){for(var t="",n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789!@#$%()_+-=~.",o=n.length,i=0;i<e;i++)t+=n.charAt(Math.floor(Math.random()*o));return t}function makeUserId(e){for(var t="",n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",o=n.length,i=0;i<e;i++)t+=n.charAt(Math.floor(Math.random()*o));return t}function meetPasswordRules(e){return!1}function makeidUpperCase(e){let t="",n="ABCDEFGHIJKLMNOPQRSTUVWXYZ".length;for(var o=0;o<e;o++)t+="ABCDEFGHIJKLMNOPQRSTUVWXYZ".charAt(Math.floor(Math.random()*n));return t}function makeidLowerCase(e){let t="",n="abcdefghijklmnopqrstuvwxyz".length;for(var o=0;o<e;o++)t+="abcdefghijklmnopqrstuvwxyz".charAt(Math.floor(Math.random()*n));return t}function makeidDigits(e){let t="",n="0123456789".length;for(var o=0;o<e;o++)t+="0123456789".charAt(Math.floor(Math.random()*n));return t}function makeidSymbol(e){let t="",n="!@#$%^&*()_+{}[]-=~`<>,./?><\":;'",o=n.length;for(var i=0;i<e;i++)t+=n.charAt(Math.floor(Math.random()*o));return t}function getValue(e,t){let n=document.forms[e][t];return null==n?"":n.value}function showDiv(e,t){let n=document.getElementById(e);null!=n&&(n.style.display=t?"block":"none")}function forceDark(){document.querySelectorAll("input").forEach(e=>{e.classList.add("forceDarki")}),document.querySelectorAll("textarea").forEach(e=>{e.classList.add("forceDark")})}function disableButtons(e){const t=document.querySelectorAll("button");for(var n=0;n<t.length;n++)t[n].disabled=e}function disableCtl(e,t=!1){document.getElementById(e).disabled=t}function enableCtl(e,t=!0){document.getElementById(e).disabled=!t}function showMessageAt(e,t,n=""){let o=document.getElementById(e);o&&(t.length>0?o.innerHTML=`<div class="alert alert-success">\n\t\t<strong>${n}</strong> ${t}\n\t</div>\n\t`:o.innerHTML="")}function showMessage(e,t=""){0==t.length&&(t=statusSuccess);let n=document.getElementById("result");e.length>0?n.innerHTML=`<div class="alert alert-success">\n\t\t<strong>${t}</strong> ${e}\n\t</div>\n\t`:n.innerHTML=""}function showInfo(e,t=""){0==t.length&&(t='<i class="fas fa-info-circle"></i>');let n=document.getElementById("result");e.length>0?n.innerHTML=`<div class="alert alert-info">\n\t\t<strong>${t}</strong> ${e}\n\t</div>\n\t`:n.innerHTML=""}function showInfoAt(e,t,n=""){0==n.length&&(n='<i class="fas fa-info-circle"></i>');let o=document.getElementById(e);t.length>0?o.innerHTML=`<div class="icon-size alert alert-info">\n\t\t<strong>${n}</strong> ${t}\n\t</div>\n\t`:o.innerHTML=""}function showError(e){lastError=e,e.length>0&&console.error("ERROR:",e),document.getElementById("result").innerHTML=`<div class="alert alert-danger">\n\t<strong>${statusError}</strong> ${e}\n  </div>`}function debugMessage(e){if(console.log("debugMessage()",showDebug,e),showDebug){let t=document.getElementById("debug");t&&(t.innerHTML=`<h3 class="text-warning  text-center ">${e}</h3`)}}function showWarning(e,t=""){0==t.length&&(t=statusWarning),document.getElementById("result").innerHTML=`<div class="alert alert-warning">\n\t<strong>${t}</strong>${e}\n  </div>`}function showMessageIn(e,t){let n=document.getElementById(e);n?n.innerHTML=`<h3 class="row text-info">${t}</h3>`:showError(`Invalid div: [${e}]`),t.length>0?showBlock(e):hideControl(e)}async function readTextFile(){try{fileHandle=await window.showOpenFilePicker();const e=await fileHandle[0].getFile();data=await e.text()}catch(e){console.error("readTextFile() EXCEPTION",e),data=""}return data}function setText(e,t){let n=document.getElementById(e);n?n.innerText=t:console.error("setText() error:",e,t)}function saveBlobToDisk(e,t){showError(""),supported&&"https:"==location.protocol&&!fileHandle&&(fileHandle=getNewTextFileHandle()),globalResult=!1;let n=downloadBlob(t,e);null!=n&&(globalResult=!1,result=!1,n.click()),showMessage(globalResult?"The data was saved succesfully":"The data was saved to your Downloads folder")}function textToBlob(e){return new Blob([e],{type:"text/plain"})}async function openImageFile(){if(mobile&&event.preventDefault(),settingsOpen&&toggleSettings(),sysInfoOpen&&toggleSysInfo(),clear(),hideControl("bigFile"),hideControl("divInputText"),fileMode="Binary",manualText=!1,data="",supported)await openImageFileAPI().then(e=>{});else{readBase64=!0,document.getElementById("files").click()}}function writeInnerHTML(e,t){let n=document.getElementById(e);n&&(n.innerHTML=t)}function toggleMedia(){mobile&&event.preventDefault(),mediaOpen=!mediaOpen,(encryptionDone||decryptionDone)&&showMessage("Process complete."),mediaOpen?(showBlock("divMedia"),hideControl("divView"),showBlock("divHide")):(hideControl("divMedia"),hideControl("divHide"),showBlock("divView"))}function handleMessage(e){alert("got message "+e)}function setupHandler(){document.getElementById("myPdf").messageHandler={onMessage:handleMessage}}function getSizeText(e){let t=e,n="bytes.",o="";t>1024&&t<1048576?(t=Math.round(t/1024),n="KB."):t>1048576&&(n="MB.",t=Math.round(t)/1048576);let i=t.toString(),a=i.indexOf(".");return a>=0&&i.length>a+2&&(i=i.substr(0,a+2)),o=`${i} ${n}`}function isEncryptedData(){return encryptedFile=data.includes("data:")&&data.includes("data2:")&&data.includes("data3:")}function confirmDownload(){mobile&&event.preventDefault(),hideControl("divDownload"),showBlock("divDownload2"),showError("Confirm Download/Save!. File will be unencrypted. Dispose properly.")}function doDownload(){mobile&&event.preventDefault(),data.length>0?(usingFile?(selFile.type.includes("pdf")?downloadFile():selFile.type.includes("text"),downloadDataFile(data,fileName)):downloadDataFile(data,fileName),hideControl("divDownload"),showMessage(`${saveIcon} OK. Saved to Downloads folder`)):showError("No data to download.")}async function testRemote(){try{const e=await fetch("https://drive.google.com/file/d/1DtZwzILQNZwKH-e-kHJ5_pucflS-Anac/view?usp=sharing",{method:"GET",mode:"no-cors"});if(200===e.status){const t=await e.json();this.listApp=t,this.listApp.forEach(e=>{"DISCONNECTED"===e.status&&this.listDecApp.push(e)}),this.nbr=this.listDecApp.length}else 400===e.status&&(this.errors=["Invalid app_permissions value. (err.400)"]),401===e.status&&(this.errors=["Acces denied. (err.401)"])}catch(e){console.log(e),this.errors=["Une erreur est survenue lors de la rcupration des informations sur le serveur."]}}function getFileInstructions(){let e="";return usingFile&&(e=`\nInstructions:\n2. Locate file with extension Crypti.txt\n1. Go to Link\n2. Open file\n3. Enter Password.\n4. Decrypt.\n\nLink: ${landingLink}\n`),e}function getInstructions(){let e="";return config.SendInstructions&&(e=usingFile?"\nInstructions:\n1. Go to Link\n2. Open this file\n3. Enter Password.\n4. Decrypt.\n":"\nInstructions:\n1. Copy Message in Source\n2. Go to Link\n3. Paste Message\n4. Enter Password\n5. Decrypt.\n"),e}async function openRemote(e){fetch(e).then(e=>e.json()).then(e=>{e.map(function(e){})})}function showSpinner(e=!0,t="Loading..."){e?(hideControl("main"),showInfo(t),showBlock("spinner")):(showBlock("main"),hideControl("spinner"),showMessage(""))}function handleError(e){showError(e),2==page&&nextPage()}async function openFile(e){gotoPage(1),data="",setField("inputText",""),fileMode="Text",readBase64=!1,supported?await openTextFileAPI2().then(e=>{}):showBlock(e)}async function openEncryptedFile(e){supported?await openTextEncryptedFileAPI2().then(e=>{showData()}):showBlock(e)}function toggleIcon(e,t,n="fa-eye",o="fa-eye-slash"){e=!e,document.getElementById(t).addEventListener("click",function(t){e?this.classList.toggle(n):this.classList.toggle(o)})}async function openTextFile(e){fileMode="Text",supported?await openTextFileAPI().then(e=>{showData(),hideControl("fileSelection")}):showBlock(e)}function openBinFile(e){var t=document.getElementById(e).files,n=new Blob([t[0]]),o=new FileReader;return o.readAsArrayBuffer(n),o.onload=function(){let e=o.result;return new Uint8Array(e)},[]}async function getNewTextFileHandle(e=".txt"){if(!supported)return null;const t={types:[{description:"Text Files",accept:{"text/plain":[e]}}]};return await window.showSaveFilePicker(t)}function doToast(e,t){let n=document.getElementById(e);n&&n.toast(t)}function copyToClipboardNew(e,t=!1){return navigator.clipboard.writeText(e).then(()=>{canCopy=!0}).catch(e=>{canCopy=!1,showError("Error copying to clipboard. "+e),console.error("Can not copy clipboard via AP",e)}),canCopy}function saveTextToFile(e,t){new Blob([t],{type:"text/plain;charset=utf-8"})}function showResultMessage(e){e.result>=0?showMessage(e.message):showError(e.message)}function showErrorIn(e,t){let n=document.getElementById(e);n?n.innerHTML=`<h6 class="row text-danger">${t}</h6`:showError(`Invalid div: [${e}]`),t.length>0?showBlock(e):hideControl(e)}function showLog(e){showInDiv("logs",e)}function getCurrentText(e){return document.querySelector(`#${e}`).innerHTML}function setCurrentText(e,t){document.querySelector(`#${e}`).innerHTML=t}function copyToClipboardOld(e){var t=document.getElementById(e);t&&(t.select(),document.execCommand("copy"))}function copyToClipboardInField(e,t,n){setValue(e,t,n);var o=document.getElementById(t);o&&(o.select(),document.execCommand("copy")),setValue(e,t,"")}function copyToClipboard(e,t,n=""){n.length>0?(document.getElementById(n).select(),document.execCommand("copy"),setValue(e,n,"")):navigator.clipboard.writeText(t).then(()=>{canCopy=!0}).catch(e=>{canCopy=!1,console.error("Can not copy clipboard via AP",e)});return canCopy}function copyToClipboardTest(e){showBlock("PS2"),setValue("main","DP2",e),document.getElementById("DP2").select(),document.execCommand("copy"),setValue("main","DP2","")}function getFormData(e){var t=document.forms[e];let n={};var o=new FormData(t);for(var[i,a]of o)n[i]=a;return n}function readFile(e){let t=e.files[0];data="";let n=new FileReader;return n.readAsText(t),n.onload=function(){data=n.result},n.onerror=function(){console.error(n.error)},text}function readRemoteFile(e){fetch(`file:///${e}`).then(e=>e.arrayBuffer()).then(e=>{console.log(e)}).catch(e=>console.error(e))}function hideControl(e){let t=document.getElementById(e);t?t.style.display="none":addTrace(`hideControl(${e}) invalid control`)}function showInLine(e){document.querySelector(`#${e}`).style.display="inline"}function showBlock(e){let t=document.getElementById(e);t?t.style.display="block":addTrace(`showBlock(${e}) undefined`,"ERROR")}function showTitle(){writeInnerHTML("divTitle",`<label>Cryptico ${environment} Version: ${versionNumber}</label>`)}function getTimeStamp(e=null){return null==e&&(e=new Date),e.toISOString()}function getTimeStampString(e){return e.getUTCFullYear()+"/"+("0"+(e.getUTCMonth()+1)).slice(-2)+"/"+("0"+e.getUTCDate()).slice(-2)+" "+("0"+e.getUTCHours()).slice(-2)+":"+("0"+e.getUTCMinutes()).slice(-2)+":"+("0"+e.getUTCSeconds()).slice(-2)}function addTrace(e,t="MSG"){getTimeStamp();traces.push(e),console.log(e),renderTrace()}function renderTrace(e="trace"){let t="",n='<table class="table">',o="";for(let e=0;e<traces.length;e++){t+=`${traces[e]}</br>`,console.log("renderTrace()",traces[e]);let n=traces[e].split("\t");o=`${o}\n\t\t<tr>\n\t\t<td>\n\t\t${n[0]}\n\t\t</td>\n\t\t<td>\n\t\t${n[1]}\n\t\t</td>\n\t\t<td>\n\t\t${n[2]}\n\t\t</td>\n\t\t</tr>`}if(n=`${n}</table>${o}`,traceEnabled){document.getElementById(e).innerHTML=n,showBlock("trace")}else localStorage.setItem("trace",n)}function viewPassword(e,t){const n=document.getElementById(t),o=document.getElementById(e);n.addEventListener("click",function(e){const t="password"===o.getAttribute("type")?"text":"password";o.setAttribute("type",t),this.classList.toggle("fa-eye-slash")})}function decodeClipBoard(e){if(encryptedText=!1,0==e.length)return showWarning("No data in clipboard."),"";console.log(`Utils.pasteClipboard() [${e}]`);let t=e.toLowerCase().indexOf("http");t>=0&&(e=e.substr(0,t));let n=e.split("|");return(cb={}).Hint="",cb.Text="",console.log("parts",n),1==n.length?cb.Text=n[0]:n.length>=3&&(cb.Hint=n[1],cb.Text=n[2].trim(),encryptedText=!0),console.log("cb",cb),console.log("cb.Text:",cb.Text),setField("pwdHint",cb.Hint),setField("inputText",cb.Text),showBlock("divIputText"),showMessage(`Text copied from clipboard. (${cb.Text.length} bytes.)`),cb.Text}function pasteClipboard(){try{navigator.clipboard.readText().then(e=>(canPaste=!0,e.length>0?(dataFromClipboard=!0,manualText=!1,usingFile=!1,data=e.replace(landingLink,""),noFocus=!0,showData(),data):(showWarning("Clipboard is empty."),""))).catch(e=>{showError("Error pasting from clipboard. "+e),canPaste=!1})}catch(e){showError("Exception reading the clipboard. "+e.message),canPaste=!1}return""}function clearTrace(){traces=[]}function getUserEmail(){try{google.script.run.withFailureHandler(failureHandler).withSuccessHandler(processResponse).getUser()}catch(e){showError(`Cannot access Server from. <b>${location.protocol}//</b> protocol.`),loadTotals()}}function failureHandler(e){showSpinner(!1),showError("Error in Server "+e),showMessageAt("divTitle","Error in Server "+e)}function processResponse(e){userEmail=e,console.log("processResponse()",e),setField("txUserId",userEmail),showMessageAt("divTitle",`Welcome ${userEmail}`),initConfig()}function failureRegister(e){showSpinner(!1),console.log("registerFirstTime() failure"),showError("Server Error:"+e)}function successRegister(e){console.log("successRegister()",e),showMessageAt(`${userEmail} Registered Succesfully.`),config.ServerId=Number(e),showMessage(`Server response: [${e}] `),"0"!=e&&(saveConfig(),saveTotals())}function registerFirstTime(){config.ServerId&&0!=config.ServerId||(config.ServerId=0,totals.StartDate=getTimeStamp(new Date),totals.EndDate=totals.StartDate,console.log("calling server *********"),google.script.run.withFailureHandler(failureRegister).withSuccessHandler(successRegister).recordFirstTime(totals))}function successUpdate(e){e&&(createTotals(),saveTotals())}function failureUpdate(e){showSpinner(!1),console.log("updateServerRecord() failure"),showError("Server Error:"+e)}function updateServerRecord(){totals.UserId=config.UserId,totals.ServerId=config.ServerId,google.script.run.withFailureHandler(failureUpdate).withSuccessHandler(successUpdate).updateServerRecord(totals)}function createMenu(){console.log("createMenu()");let e=document.getElementById("iconMenu");e&&(e.innerHTML=mobile?'\n    <div id="icons" class="separation-menu row card2 text-center">\n    \x3c!--\n    <div id="divEmpty" class="col-md-1"></div>\n    fas fa-eraser\n    --\x3e\n\n    <div id="divClear" class="text-center">\n    <button class="btn btn-secondary separation-btn-right">\n      <i class="fa fa-home" title="Hoome" id="iconClear"\n         style="margin-left: -10px; cursor: pointer;" onclick="doClear()"></i>\n         </button>\n\n    </div>\n\n\n    <div id="divInfo" class="text-center">\n    <button class="btn btn-secondary separation-btn-right">\n      <i class="fas fa-info-circle " title="System Info" id="clearText"\n         style="margin-left: -10px; cursor: pointer;" onclick="toggleSysInfo()"></i>\n         </button>\n    </div>\n\n    <div id="divSettings" class="text-center">\n    <button class="btn btn-secondary separation-btn-right">\n      <i class="fas fa-cog" title="System Info" id="settings"\n         style="margin-left: -10px; cursor: pointer;" onclick="toggleSettings()"></i>\n         </button>\n    </div>\n\n\n\n\n    <div id="divPaste" class="text-center">\n    <button class="btn btn-secondary separation-btn-right">\n      <i class="fas fa-paste" title="Paste Text from Clipboard" id="pasteClipboard" style="cursor: pointer;"\n        onclick="selectPaste()"></i>\n        </button>\n    </div>\n\n\n\n    <div id="divOpenFile" class="text-center">\n    <button class="btn btn-secondary separation-btn-right">\n      <i class="fas fa-folder-open" title="Open File" id="clearText"  style="margin-left: -10px; cursor: pointer;"\n        onclick="openImageFile()"></i>\n        </button>\n    </div>\n\n\n    <div id="divEncrypt" class="text-center" style="display:none">\n    <button class="btn btn-secondary separation-btn-right">\n      <i class="fas fa-user-secret" title="Encrypt" id="clearText"  style="margin-left: -10px; cursor: pointer;"\n        onclick="doEncryptNew()"></i>\n        </button>\n    </div>\n\n\n    <div id="divDecrypt" class="text-center" style="display:none">\n    <button class="btn btn-secondary separation-btn-right">\n          <i class="fa fa-unlock" title="Encrypt" id="clearText"  style="margin-left: -10px; cursor: pointer;"\n        onclick="doDecryptNew()"></i>\n        </button>\n    </div>\n\n    <div class="col-md-1" id="divShare" style="display: none;">\n    <button class="btn btn-secondary separation-btn-right">\n      <i class="fas fa-share" id="shareIt"  style="margin-left: -10px; cursor: pointer;" onclick="doShare()"\n        title="Share Results"></i>\n        </button>\n    </div>\n\n\n\n    <div id="divView" class="text-center" style="display:none">\n    <button class="btn btn-secondary separation-btn-right">\n      <i class="far fa-eye" title="View Media" id="viewMedia"  style="margin-left: -10px; cursor: pointer;"\n        onclick="toggleMedia()"></i>\n        </button>\n    </div>\n\n    \n    <div id="divHide" class="text-center" style="display:none">\n    <button class="btn btn-secondary separation-btn-right">\n      <i class="far fa-eye-slash" title="Hide Media" id="viewMedia"  style="margin-left: -10px; cursor: pointer;"\n        onclick="toggleMedia()"></i>\n        </button>\n    </div>\n\n    <div id="divDownload" class="text-center" style="display: none">\n    <button class="btn btn-secondary separation-btn-right">\n      <i class="fa fa-save red" title="Download" id="iconDownload"  style="margin-left: -10px; cursor: pointer;"\n        onclick="confirmDownload()"></i>\n        </button>\n    </div>\n\n    <div id="divDownload2" class="text-center" style="display: none">\n    <button class="btn btn-secondary separation-btn-right">\n      <i class="fa fa-save green" title="Download" id="iconDownload"  style="margin-left: -10px; cursor: pointer;"\n        onclick="doDownload()"></i>\n        </button>\n    </div>\n\n\n    <div id="divInputPDF" class="text-center" style="display: none">\n    <button class="btn btn-secondary separation-btn-right">\n      <i class="fas fa-file-pdf" title="View PDF" id="iconInputPDF"  style="margin-left: -10px; cursor: pointer;"\n        onclick="viewInputPDF()"></i>\n        </button>\n    </div>\n\n\n    <div id="divCopy" class="text-center" style="display:none">\n    <button class="btn btn-secondary separation-btn-right">\n      <i class="fas fa-copy red" title="Copy" id="copy"  style="margin-left: -10px; cursor: pointer;"\n        onclick="doCopy()"></i>\n        </button>\n    </div>\n\n\n    <div id="divNext" class="text-center">\n    <button class="btn btn-secondary separation-btn-right">\n      <i class="fas fa-arrow-right" title="Next" id="iconNext"  style="margin-left: -10px; cursor: pointer;"\n        onclick="nextPage()"></i>\n        </button>\n    </div>\n\n  </div>\n':'\n    <div id="icons" class="separation-menu row icon-size2 card2">\n    \x3c!--\n    <div id="divEmpty" class="col-md-1"></div>\n    fas fa-eraser\n    --\x3e\n\n    <div id="divClear" class="col-md-2 text-center">\n      <i class="fa fa-home" title="Hoome" id="iconClear"\n         style="margin-left: -10px; cursor: pointer;" onclick="doClear()"></i>\n\n    </div>\n\n\n    <div id="divInfo" class="col-md-2 text-center">\n      <i class="fas fa-info-circle " title="System Info" id="clearText"\n         style="margin-left: -10px; cursor: pointer;" onclick="toggleSysInfo()"></i>\n    </div>\n\n    <div id="divSettings" class="col-md-2 text-center">\n      <i class="fas fa-cog" title="System Info" id="settings"\n         style="margin-left: -10px; cursor: pointer;" onclick="toggleSettings()"></i>\n    </div>\n\n\n\n\n    <div id="divPaste" class="col-md-2 text-center">\n      <i class="fas fa-paste" title="Paste Text from Clipboard" id="pasteClipboard" style="cursor: pointer;"\n        onclick="selectPaste()"></i>\n    </div>\n\n\n\n    <div id="divOpenFile" class="col-md-2 text-center">\n      <i class="fas fa-folder-open" title="Open File" id="clearText"  style="margin-left: -10px; cursor: pointer;"\n        onclick="openImageFile()"></i>\n    </div>\n\n\n    <div id="divEncrypt" class="col-md-2 text-center" style="display:none">\n      <i class="fas fa-user-secret" title="Encrypt" id="clearText"  style="margin-left: -10px; cursor: pointer;"\n        onclick="doEncryptNew()"></i>\n    </div>\n\n\n    <div id="divDecrypt" class="col-md-2 text-center" style="display:none">\n      <i class="fa fa-unlock" title="Encrypt" id="clearText"  style="margin-left: -10px; cursor: pointer;"\n        onclick="doDecryptNew()"></i>\n    </div>\n\n    <div class="col-md-2" id="divShare" style="display: none;">\n      <i class="fas fa-share" id="shareIt"  style="margin-left: -10px; cursor: pointer;" onclick="doShare()"\n        title="Share Results"></i>\n    </div>\n\n\n\n    <div id="divView" class="col-md-2 text-center" style="display:none">\n      <i class="far fa-eye" title="View Media" id="viewMedia"  style="margin-left: -10px; cursor: pointer;"\n        onclick="toggleMedia()"></i>\n    </div>\n\n    \n    <div id="divHide" class="col-md-2 text-center" style="display:none">\n      <i class="far fa-eye-slash" title="Hide Media" id="viewMedia"  style="margin-left: -10px; cursor: pointer;"\n        onclick="toggleMedia()"></i>\n    </div>\n\n    <div id="divDownload" class="col-md-2 text-center" style="display: none">\n      <i class="fa fa-save red" title="Download" id="iconDownload"  style="margin-left: -10px; cursor: pointer;"\n        onclick="confirmDownload()"></i>\n    </div>\n\n    <div id="divDownload2" class="col-md-2 text-center" style="display: none">\n      <i class="fa fa-save green" title="Download" id="iconDownload"  style="margin-left: -10px; cursor: pointer;"\n        onclick="doDownload()"></i>\n    </div>\n\n\n    <div id="divInputPDF" class="col-md-2 text-center" style="display: none">\n      <i class="fas fa-file-pdf" title="View PDF" id="iconInputPDF"  style="margin-left: -10px; cursor: pointer;"\n        onclick="viewInputPDF()"></i>\n    </div>\n\n\n    <div id="divCopy" class="col-md-2 text-center" style="display:none">\n      <i class="fas fa-copy red" title="Copy" id="copy"  style="margin-left: -10px; cursor: pointer;"\n        onclick="doCopy()"></i>\n    </div>\n\n\n    <div id="divNext" class="col-md-2 text-center">\n      <i class="fas fa-arrow-right" title="Next" id="iconNext"  style="margin-left: -10px; cursor: pointer;"\n        onclick="nextPage()"></i>\n    </div>\n\n  </div>\n')}function closeAllAux(){currentSection.length>0&&hideControl(currentSection),currentSection="",settingsOpen=!1,logOpen=!1,sysInfoOpen=!1}function setSourceData(e=""){data="";let t=!1;return e&&0!=e.length||(e=getField("inputText")),e.length>0?(data=e,t=!0):(showError("Enter data to encrypt."),1==page&&nextPage()),t}function validateHint(){fieldTouched&&nextPage()}function enableOptions(){hideControl("divInfo");let e=getField("userPassword");canProcess&&e.length>=config.MinPwdLen&&data.length>0&&!encryptionDone&&!decryptionDone?(showBlock("divEncrypt"),showBlock("divDecrypt")):(hideControl("divEncrypt"),hideControl("divDecrypt")),encryptionDone||decryptionDone?(hideControl("divNext"),hideControl("PAGE1"),hideControl("PAGE2"),usingFile?hideControl("divShare"):showBlock("divShare"),decryptionDone&&usingFile&&(showBlock("divDownload"),hideControl("divShare"))):encryptionDone||decryptionDone||(canProcess&&showBlock("divNext"),hideControl("divDownload"),hideControl("divShare"),hideControl("divCopy")),manualText&&(showBlock("divPaste"),hideControl("divMedia")),canProcess||hideControl("divNext")}function gotoPage(e){hideControl(currentSection=`PAGE${page}`),(page=e)>totalPages&&(page=1),currentSection=`PAGE${page}`,showBlock(`PAGE${page}`),togglePage()}function nextPage(){mobile&&event.preventDefault(),handleSysIcons(),hideControl(currentSection=`PAGE${page}`),++page>totalPages&&(page=1),currentSection=`PAGE${page}`,showBlock(`PAGE${page}`),togglePage()}function showSection(e){addTrace(`showSection(${e})`),currentSection.length>0&&hideControl(currentSection),currentSection=e,showBlock(e)}async function doCopy(){mobile&&event.preventDefault(),copyToClipboardNew(data,!0)}function pasteFromClipboard(e){mobile&&event.preventDefault(),pasteClipboard()}function finishInputText(){showMessage(""),0==data.length&&(data=getField("inputText")),showData()}function selectPaste(){closeAllAux(),handleSysIcons(),reset(),hideControl("divInputText"),toggleInitialIcons(),hideControl("bigFile");pasteClipboard()}function selectText(){handleSysIcons(),clear(),toggleInitialIcons(),hideControl("bigFile")}function setData(e){manualText=!0}function finishText(){(data=getField("inputText")).length>0&&(setField("loadedText",data),manualText=!0,currentMedia=" divText")}function getPassword(){return getField("userPassword")}function checkPassword(){let e=getField("userPassword"),t=data.length>0&&e.length>=config.MinPwdLen;return t&&(showBlock("divEncrypt"),encryptedFile&&showBlock("divDecrypt")),t}function validatePassword(e){console.log("validatePassword"),e||(e=getPassword());let t=!1;return(t=e.length>=pwdLen)||(2!=page&&gotoPage(2),showError(`Password must be minimum ${pwdLen} in length`,statusError)),t}function finishPage(){mobile||nextPage()}function firstData(){console.log("firstData()"),hideControl("divInfo"),hideControl("divSettings")}function performEncrypt(){let e=doEncrypt();showResultMessage(e),e.result>=0&&(hideControl("PAGE1"),hideControl("PAGE2"))}function handleSysIcons(){showMessage(""),sysIcons&&(hideControl("divInfo"),hideControl("divSettings"),sysIcons=!1)}function showPasswordMessage(){getPassword().length<config.MinPwdLen&&(hideControl("divMedia"),hideControl("divInputText"),gotoPage(2),showWarning("Optional <i>Password Hint</i>, <b>Password. (*Required)</b>",statusWarning),setFocus("userPassword"))}function warningMessage(){let e=`Type or ${pasteIcon} Paste Text, or ${folderIcon} Open a File.`;0==data.length&&showWarning(e)}function togglePage(){if(showMessage(""),1==page)warningMessage(),(usingFile||data.length>0)&&(hideControl("divInputText"),(manualText||dataFromClipboard)&&showMedia("divText")),mediaOpen?(showBlock(currentMedia),showBlock("divMedia"),showBlock("divFileInfo"),showBlock("divHide")):(hideControl("divMedia"),hideControl("divHide"));else if(2==page){getPassword().length<config.MinPwdLen&&(showWarning("Optional <i>Password Hint</i>, <b>Password. (*Required)</b>",statusWarning),setFocus("userPassword")),encryptedFile||manualText||dataFromClipboard?showFileInfo():(hideControl("divMedia"),hideControl("divView"),hideControl("divHide"))}}function isDataReady(){let e=getField("userPassword");return data.length+e.length>=0}function toggleInitialIcons(){isDataReady()?(hideControl("divSettings"),hideControl("divInfo")):(showBlock("divSettings"),showBlock("divInfo")),showBlock("divNext")}function toggleCanProcess(e,t){e||(setIconsStateInitial(),gotoPage(1),showError(`File too big (${t}) for current RAM Memory.(${navigator.deviceMemory})GB`,statusWarning))}function toggleClear(){console.log("toggleClear()"),isDataReady()||2==page&&gotoPage(1)}function setIconsStateInitial(){hideControl("divInfo"),hideControl("divSettings"),hideControl("divShare"),hideControl("divCopy"),hideControl("divEncrypt"),hideControl("divDecrypt"),hideControl("divDownload"),hideControl("divMedia"),hideControl("PAGE2"),hideControl("divView"),hideControl("divHide"),showBlock("divPaste")}function reset(){clear()}function doClear(){clear()}function closeHelp(){hideControl("divHelp")}function showHelp(){if(config.ShowHelp){showInfoAt("helpText",`Icon legends:</br>\n${homeIcon} Start, Clear All, Enter manual text</br>\n${infoIcon} System Info</br>\n${settingsIcon} Settings</br>\n${copyIcon} Copy decrypted text</br>\n${pasteIcon} Paste text</br>\n${folderIcon} Open local file</br>\n${pdfIcon} See loaded PDF ( Desktop only )</br>\n${encryptIcon} Encrypt Loaded Data</br>\n${decryptIcon} Decrypt Loaded Data</br>\n${eyeIcon} See Media</br>\n${hideIcon} Hide Media</br>\n${shareIcon} Share Encrypted text</br>\n${saveIcon} Save Decrypted data</br>\n${nextIcon} Next page</br>\n`),showBlock("divHelp")}else hideControl("divHelp")}function clear(){mobile&&event.preventDefault(),console.clear(),closeAllAux(),hideControl("divHelp"),(encryptionDone||decryptionDone)&&clearMedia(),document.getElementById("mainForm").reset(),fieldTouched=!1,encryptedFile=!1,usingFile=!1,readBase64=!1,data="",mediaOpen=!1,fileDecrypted=!1,encryptionDone=!1,encryptedText=!1,decryptionDone=!1,dataFromClipboard=!1,canProcess=!0,currentMedia="",data="",noFocus=!1,sysIcons=!0,manualText=!1,isPDF=!1,gotoPage(1),setIconsStateInitial(),showBlock("divInfo"),showBlock("divSettings"),showBlock("divNext"),showBlock("divInputText"),showBlock("divPaste"),showBlock("divOpenFile"),hideControl("divInputPDF"),hideControl("divFileInfo"),hideControl("divDownload"),hideControl("divDownload2"),showBlock("result"),showTitle(),hideControl("divView"),hideControl("divHide")}function setOffHelpMessage(e){config.ShowHelp=e,saveConfig(),hideControl("divHelp")}function setFieldTouched(){fieldTouched=!0}function enableInput(){console.log("enableInput"),(manualText||dataFromClipboard)&&(setField("inputText",data),showBlock("divInputText"),toggleMedia())}function viewInputPDF(){if(mobile&&event.preventDefault(),!mobile||mobile){window.open("").document.write(`<iframe width='100%' height='100%' src='${data}'></iframe>`)}}function openPDF(){if(mobile)doDownload(data,fileName);else{window.open("").document.write(`<iframe width='100%' height='100%' src='${data}'></iframe>`)}}function renderPDF(){if(!mobile){let e=`<iframe width='100%' height='100%'  src='${data}'></iframe>`;e=`<iframe src='${data}'></iframe>`;document.getElementById("divPDF");writeInnerHTML("divPDF",e),showBlock("divPDF")}}function resetHard(){clear(),skipLanding=!0,addInstructions=!0,hideControl("encryptActions");for(let e=0;e<20;e++)copyToClipboardNew(makeid(64)),showMessage(`Reset complete.(${e})`);showMessage("Reset Complete.")}function doReadFile(e){showMessage("Reading file..."),handleFileSelect(e),showData()}function toggleSysInfo(){mobile&&event.preventDefault(),hideControl("divHelp"),settingsOpen&&toggleSettings(),(sysInfoOpen=!sysInfoOpen)?(currentSection="divSysInfo",hideControl("PAGE1"),hideControl("PAGE2"),showInfo("System Info"),console.log("userEmail",userEmail),showBlock("divSysInfo")):(showInfo(""),hideControl("divSysInfo"),gotoPage(1))}function toggleSettings(){mobile&&event.preventDefault(),hideControl("divHelp"),(settingsOpen=!settingsOpen)?(currentSection="divSysSettings",hideControl("PAGE1"),hideControl("PAGE2"),showInfo("Settings"),configChanged=!1,showBlock("divSysSettings")):getSettingsSave()&&(hideControl("divSysSettings"),gotoPage(1),showInfo("Settings updated."))}function getTotalsText(){return`</br></br>\n    ${encryptIcon} ${totals.te}, ${getSizeText(totals.teb)} \n    ${decryptIcon} ${totals.td}, ${getSizeText(totals.tdb)} \n    ${encryptIcon}${decryptIcon} ${totals.te+totals.td}, ${getSizeText(totals.teb+totals.tdb)}</br>\n    `}function hideSysInfo(){gotoPage(1),hideControl("sysInfo")}function function6(){window.onerror=function(e,t,n){showError(`${e}</br>${t}</br>Line:${n}`)},mobile=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent),setField("txDarkMode",darkMode),setField("txFileAPISupported",supported.toString()),setField("txCanCopy",canCopy.toString()),setField("txUserAgent",navigator.userAgent),setField("txProtocol",location.protocol),setField("txWidth",window.innerWidth),setField("txMobile",mobile),setField("txRAM",navigator.deviceMemory.toString()),setField("txUserId",userEmail),maxData=1024*navigator.deviceMemory*1024*3;const e=document.getElementById("togglePassword"),t=document.getElementById("userPassword");e.addEventListener("click",function(e){const n="password"===t.getAttribute("type")?"text":"password";t.setAttribute("type",n),this.classList.toggle("fa-eye-slash")}),document.getElementById("files").addEventListener("change",handleFileSelect,!1),fileSelectionDiv="fileSelection",supported||(document.getElementById("files").addEventListener("change",handleFileSelect,!1),fileSelectionDiv="fileSelection"),showBlock("iconMenu"),warningMessage(),"https:"!=location.protocol&&(console.log("initializing config for local protocols."),initConfig()),mobile=!0,createMenu(),window.addEventListener("keyup",function(e){e.keyCode,e.getModifierState("CapsLock")?(showWarning("CAPS Lock is ON"),CAPSLockOn=!0):CAPSLockOn=!1}),window.addEventListener("onunload",function(e){saveLogs()}),location.protocol,showHelp(),showTitle()}function createMenuNavBar(e=!1,t=!1){let n=[];n.push({icon:"fas fa-cog",parent:"",className:"btn-secondary",id:"btnSysInfo",kind:"main",method:"menuChanged",pars:"'KEYS_SELECTION','KEYS'",caption:"System info"}),n.push({icon:"fas fa-paste",parent:"",className:"btn-secondary",id:"btnPARAMETERS",kind:"main",method:"menuChanged",pars:"'PARAMETERS_SELECTION','PARAMETERS'",caption:"PARAMETERS"}),n.push({separator:"|",icon:"far fa-save",parent:"FINISH",className:"btn-secondary",id:"btnFINISH",kind:"main",method:"menuChanged",pars:"'SAVE_SELECTION','FINISH'",caption:"FINISH"}),!existingKey&&e&&currentKey.length>0&&currentValue.length>0&&"KEYS"==section&&n.push({icon:"fa-solild fa-plus",className:"btn-primary",id:"btnAdd",method:"createKey",caption:"Add"}),"KEYS"==section&&(existingKey&&currentValue.length>0&&e&&n.push({icon:"fa-solid fa-pen-to-square",className:"btn-primary",id:"btnUpdate",method:"updateKey",caption:"Update"}),currentKey.length>0&&(n.push({icon:"fa-shuffle",className:"btn-secondary",id:"btnGenerate",method:"generate",caption:"Random"}),n.push({icon:"fa-hand-sparkles",className:"btn-secondary",id:"btnRules",method:"validateMeetRules",caption:"Rules"}))),newFile&&"FINISH"==section&&n.push({icon:"fa-shuffle",className:"btn-secondary",id:"btnRandom",method:"generate2",caption:"Random"}),"KEYS"==section&&existingKey&&n.push({icon:"fa trash-can",className:"btn-danger",id:"btnDelete",method:"deleteKey",caption:"Delete"}),(kch||sch||pch)&&n.push({icon:"far fa-square",className:"btn-secondary",id:"btnClear",method:"clearForm",caption:"Clear"});let o=getValue("saveForm","dataOut").trim();"FINISH"==section&&o.length>0&&n.push({icon:"fa-regular fa-copy",className:"btn-secondary",id:"btnCopy",method:"copyToCC",pars:"dataOut",caption:"Copy"}),n.push({icon:"fa-regular fa-floppy-disk",className:"btn-success",id:"btnSave",method:"saveToDisk",caption:"Save"}),supported&&"https:"==location.protocol&&n.push({icon:"fa-solid fa-floppy-disk",onclick:'onclick="saveAsToDisk()"',caption:"Save As"}),buildMenuButtons("MENU1",n)}function doShare(){mobile&&event.preventDefault(),data.length>0?shareData("Criptyfy",data,landingLink):showError("No data to share.")}function doSharePwd(){let e=getField("userPassword");if(e.trim().length>0){shareData(`Criptyfy:\n${getField("pwdHint")} ${e}`,"")}else showError("Empty password.")}window.addEventListener("load",function6);</script>
<script id='xzY2'></script>
<script id='log'>
    console.log('SCRIPTS', document.scripts.length);
    for (var i in document.scripts) {
        try {
            console.log(i, document.scripts[i].id, document.scripts[i].text.length);
        }
        catch (ex) {
            console.log('EXCEPTION', ex);
        }
    }
    console.log('all', document.scripts);
</script>
<script id='f5'>
    var xzY1 = 'B27D772FABE915229095081D91F8A964';
    if (xzY1.length > 0) {
        let sc = document.getElementById('xzY1');
        console.log('sc', sc);
        if (sc) {
            let vr = MD5(sc.innerHTML);
            if (vr.toUpperCase() != xzY1) {

                removeElement('mainContent');
            }
        }
    }
    removeElement('f5');
    removeElement('log');

</script>